import{j as ee,h as r,D as le,Q as b,R as D,S as a,q as e,y as n,a8 as v,u as t,O as i,ad as O,V as H,F as ae,ab as te,H as oe,ag as se}from"./vendor-qaEqcc9M.js";import{u as ne}from"./useAbortOnUnmount-B_TyPYrd.js";import{$ as _,T as k,x as y,q as j,V as re,U as ie}from"./main-DUODoQpR.js";import{V as ue,r as A}from"./VForm-AfrkaUJk.js";import{a as d,V as F}from"./VRow-dBMGxjTF.js";import{V as T,d as de}from"./VCard-DEMyauu_.js";import{V as S}from"./VCardText-lEnvPJxp.js";import{V as q}from"./VSelect-BpDYXa0x.js";import{V as M}from"./VTextField-BgtisBQp.js";import{V as me}from"./VAlert-DIbLZTVg.js";import{V as ce}from"./VTable-CDiDVqFm.js";import{V as pe}from"./VChip-CzUAJTHl.js";import{V as fe}from"./VPagination-Dp4qKX6V.js";import{V as ve}from"./VDialog-8MtGyTgn.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const ye={class:"d-flex align-center justify-space-between mb-2"},Ve={class:"d-flex gap-3 justify-end"},ge={class:"text-right"},be={class:"text-right"},_e={key:0},he={colspan:"4",class:"text-center text-medium-emphasis py-6"},$e={class:"text-sm text-medium-emphasis"},Ie=ee({__name:"index",setup(Ce){ne();const R=r(!1),x=r(!1),h=r(!1),$=r(null),m=r(""),c=r({}),U=r([]),E=r([]),V=r({current_page:1,last_page:1,per_page:20,total:0}),p=r({type:null,search:""}),f=r(!1),C=r(!1),w=r(null),u=r({code:"",name:"",type:"income"}),N=r(null),z=[A()],P=[A()],I=[A()],L=l=>l==="income"?"success":l==="expense"?"error":l==="asset"?"primary":"warning",Y=async()=>{x.value=!0;try{const l=await _("/accounts/meta");E.value=l.data.types}catch(l){m.value=k(l,"Hesap turleri alınamadı.")}finally{x.value=!1}},g=async(l=1)=>{R.value=!0,m.value="";try{const o=await _("/accounts",{query:{page:l,type:p.value.type||void 0,search:p.value.search||void 0}});U.value=o.data,V.value=o.meta}catch(o){m.value=k(o,"Hesaplar alınamadı.")}finally{R.value=!1}},G=()=>{C.value=!1,w.value=null,u.value={code:"",name:"",type:"income"},c.value={}},K=()=>{G(),f.value=!0},Q=l=>{C.value=!0,w.value=l.id,u.value={code:l.code,name:l.name,type:l.type},c.value={},f.value=!0},B=async()=>{if((await N.value?.validate())?.valid){h.value=!0,m.value="",c.value={};try{C.value&&w.value?await _(`/accounts/${w.value}`,{method:"PUT",body:u.value}):await _("/accounts",{method:"POST",body:u.value}),f.value=!1,await g(V.value.current_page)}catch(o){m.value=k(o,"Hesap kaydedilemedi."),c.value=ie(o)}finally{h.value=!1}}},J=async l=>{$.value=l.id,m.value="";try{await _(`/accounts/${l.id}`,{method:"DELETE"}),await g(V.value.current_page)}catch(o){m.value=k(o,"Hesap silinemedi.")}finally{$.value=null}},W=async()=>{await g(1)},X=async()=>{p.value={type:null,search:""},await g(1)};return le(async()=>{await Promise.allSettled([Y(),g(1)])}),(l,o)=>(b(),D(F,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[n("div",ye,[o[8]||(o[8]=n("div",null,[n("h4",{class:"text-h4 mb-1"}," Hesaplar "),n("p",{class:"text-medium-emphasis mb-0"}," Gelir, gider ve diger hesap plani ")],-1)),e(y,{color:"primary","prepend-icon":"ri-add-line",onClick:K},{default:a(()=>[...o[7]||(o[7]=[v(" Yeni Hesap ",-1)])]),_:1})])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(T,{loading:t(x)},{default:a(()=>[e(S,null,{default:a(()=>[e(F,null,{default:a(()=>[e(d,{cols:"12",md:"4"},{default:a(()=>[e(q,{modelValue:t(p).type,"onUpdate:modelValue":o[0]||(o[0]=s=>t(p).type=s),items:t(E),"item-title":"label","item-value":"value",label:l.$t("common.type"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),e(d,{cols:"12",md:"8"},{default:a(()=>[e(M,{modelValue:t(p).search,"onUpdate:modelValue":o[1]||(o[1]=s=>t(p).search=s),label:l.$t("common.search"),placeholder:"Kod veya hesap adi"},null,8,["modelValue","label"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[n("div",Ve,[e(y,{variant:"outlined",onClick:X},{default:a(()=>[v(i(l.$t("common.clear")),1)]),_:1}),e(y,{color:"primary",onClick:W},{default:a(()=>[v(i(l.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),t(m)?(b(),D(d,{key:0,cols:"12"},{default:a(()=>[e(me,{type:"error",variant:"tonal"},{default:a(()=>[v(i(t(m)),1)]),_:1})]),_:1})):O("",!0),e(d,{cols:"12"},{default:a(()=>[e(T,{loading:t(R)},{default:a(()=>[e(ce,{density:"comfortable"},{default:a(()=>[n("thead",null,[n("tr",null,[n("th",null,i(l.$t("common.code")),1),n("th",null,i(l.$t("common.accountName")),1),n("th",null,i(l.$t("common.type")),1),n("th",ge,i(l.$t("common.actions")),1)])]),n("tbody",null,[(b(!0),H(ae,null,te(t(U),s=>(b(),H("tr",{key:s.id},[n("td",null,[n("code",null,i(s.code),1)]),n("td",null,i(s.name),1),n("td",null,[e(pe,{size:"small",color:L(s.type),variant:"tonal"},{default:a(()=>[v(i(s.type_label),1)]),_:2},1032,["color"])]),n("td",be,[e(y,{icon:"",size:"small",variant:"text",onClick:Z=>Q(s)},{default:a(()=>[e(j,{icon:"ri-edit-line"})]),_:1},8,["onClick"]),e(y,{icon:"",size:"small",variant:"text",color:"error",loading:t($)===s.id,disabled:t($)===s.id,onClick:Z=>J(s)},{default:a(()=>[e(j,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),t(U).length===0?(b(),H("tr",_e,[n("td",he,i(l.$t("common.noRecords")),1)])):O("",!0)])]),_:1}),e(S,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:a(()=>[n("span",$e,i(l.$t("common.totalRecords",{count:t(V).total})),1),e(fe,{"model-value":t(V).current_page,length:t(V).last_page,"total-visible":7,"onUpdate:modelValue":g},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1}),e(ve,{modelValue:t(f),"onUpdate:modelValue":o[6]||(o[6]=s=>oe(f)?f.value=s:null),"max-width":"560"},{default:a(()=>[e(T,{title:t(C)?"Hesap Düzenle":"Yeni Hesap"},{default:a(()=>[e(S,null,{default:a(()=>[e(ue,{ref_key:"formRef",ref:N,onSubmit:se(B,["prevent"])},{default:a(()=>[e(F,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(M,{modelValue:t(u).code,"onUpdate:modelValue":o[2]||(o[2]=s=>t(u).code=s),label:l.$t("common.accountCode"),rules:z,"error-messages":t(c).code??[]},null,8,["modelValue","label","error-messages"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(M,{modelValue:t(u).name,"onUpdate:modelValue":o[3]||(o[3]=s=>t(u).name=s),label:l.$t("common.accountName"),rules:P,"error-messages":t(c).name??[]},null,8,["modelValue","label","error-messages"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(q,{modelValue:t(u).type,"onUpdate:modelValue":o[4]||(o[4]=s=>t(u).type=s),items:t(E),"item-title":"label","item-value":"value",label:l.$t("common.type"),rules:I,"error-messages":t(c).type??[]},null,8,["modelValue","items","label","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(de,{class:"px-6 pb-4"},{default:a(()=>[e(re),e(y,{variant:"outlined",onClick:o[5]||(o[5]=s=>f.value=!1)},{default:a(()=>[v(i(l.$t("common.cancel")),1)]),_:1}),e(y,{color:"primary",loading:t(h),disabled:t(h),onClick:B},{default:a(()=>[v(i(l.$t("common.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}))}});export{Ie as default};
