import{$ as _,T as C,x as f,q as w}from"./main-DUODoQpR.js";import{f as U,a as j}from"./formatters-BEv4aA23.js";import{u as G,i as T}from"./useAbortOnUnmount-B_TyPYrd.js";import{V as k,a as d}from"./VRow-dBMGxjTF.js";import{V as x}from"./VCard-DEMyauu_.js";import{V as E}from"./VCardText-lEnvPJxp.js";import{V as q}from"./VSelect-BpDYXa0x.js";import{V as R}from"./VTextField-BgtisBQp.js";import{V as S}from"./VAlert-DIbLZTVg.js";import{V as z}from"./VTable-CDiDVqFm.js";import{V as M}from"./VChip-CzUAJTHl.js";import{V as I}from"./VPagination-Dp4qKX6V.js";import{j as L,h as m,D as O,Q as v,R as A,S as s,q as t,y as l,O as n,a8 as y,u as r,ad as B,V as g,F as P,ab as Q}from"./vendor-qaEqcc9M.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const Y={class:"d-flex align-center justify-space-between mb-2"},H={class:"text-medium-emphasis mb-0"},J={class:"d-flex gap-3 justify-end"},K={class:"text-right"},W={class:"text-right"},X={key:0},Z={colspan:"9",class:"text-center text-medium-emphasis py-6"},ee={class:"text-sm text-medium-emphasis"},_e=L({__name:"index",setup(le){const{withAbort:$}=G(),V=m(!1),h=m(null),u=m(""),b=m([]),c=m({current_page:1,last_page:1,per_page:20,total:0}),i=m({period:null,is_active:null,search:""}),p=async(e=1)=>{V.value=!0,u.value="";try{const a=await $(o=>_("/templates/expense",{query:{page:e,period:i.value.period||void 0,is_active:i.value.is_active===null?void 0:i.value.is_active?1:0,search:i.value.search||void 0},signal:o}));b.value=a.data,c.value=a.meta}catch(a){if(T(a))return;u.value=C(a,"Gider şablonları alınamadı.")}finally{V.value=!1}},D=async()=>{await p(1)},F=async()=>{i.value={period:null,is_active:null,search:""},await p(1)},N=async e=>{h.value=e.id,u.value="";try{await $(a=>_(`/templates/expense/${e.id}`,{method:"DELETE",signal:a})),await p(c.value.current_page)}catch(a){if(T(a))return;u.value=C(a,"Gider şablonu silinemedi.")}finally{h.value=null}};return O(()=>p(1)),(e,a)=>(v(),A(k,null,{default:s(()=>[t(d,{cols:"12"},{default:s(()=>[l("div",Y,[l("div",null,[a[3]||(a[3]=l("h4",{class:"text-h4 mb-1"}," Gider Şablonları ",-1)),l("p",H,n(e.$t("pages.expenseTemplates.indexSubtitle")),1)]),t(f,{color:"primary","prepend-icon":"ri-add-line",to:"/templates/expense/create"},{default:s(()=>[...a[4]||(a[4]=[y(" Yeni Şablon ",-1)])]),_:1})])]),_:1}),t(d,{cols:"12"},{default:s(()=>[t(x,null,{default:s(()=>[t(E,null,{default:s(()=>[t(k,null,{default:s(()=>[t(d,{cols:"12",md:"3"},{default:s(()=>[t(q,{modelValue:r(i).period,"onUpdate:modelValue":a[0]||(a[0]=o=>r(i).period=o),items:[{title:e.$t("common.monthly"),value:"monthly"},{title:e.$t("common.quarterly"),value:"quarterly"},{title:e.$t("common.yearly"),value:"yearly"}],label:e.$t("common.periodicity"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(d,{cols:"12",md:"3"},{default:s(()=>[t(q,{modelValue:r(i).is_active,"onUpdate:modelValue":a[1]||(a[1]=o=>r(i).is_active=o),items:[{title:e.$t("common.active"),value:!0},{title:e.$t("common.passive"),value:!1}],label:e.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(d,{cols:"12",md:"6"},{default:s(()=>[t(R,{modelValue:r(i).search,"onUpdate:modelValue":a[2]||(a[2]=o=>r(i).search=o),label:e.$t("common.search"),placeholder:e.$t("common.templateNamePlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),t(d,{cols:"12"},{default:s(()=>[l("div",J,[t(f,{variant:"outlined",onClick:F},{default:s(()=>[y(n(e.$t("common.clear")),1)]),_:1}),t(f,{color:"primary",onClick:D},{default:s(()=>[y(n(e.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),r(u)?(v(),A(d,{key:0,cols:"12"},{default:s(()=>[t(S,{type:"error",variant:"tonal"},{default:s(()=>[y(n(r(u)),1)]),_:1})]),_:1})):B("",!0),t(d,{cols:"12"},{default:s(()=>[t(x,{loading:r(V)},{default:s(()=>[t(z,{density:"comfortable"},{default:s(()=>[l("thead",null,[l("tr",null,[l("th",null,n(e.$t("common.template")),1),l("th",null,n(e.$t("common.vendor")),1),l("th",null,n(e.$t("common.account")),1),a[5]||(a[5]=l("th",{class:"text-right"}," Tutar ",-1)),l("th",null,n(e.$t("common.due")),1),l("th",null,n(e.$t("common.periodicity")),1),l("th",null,n(e.$t("common.status")),1),l("th",null,n(e.$t("common.lastGenerated")),1),a[6]||(a[6]=l("th",{class:"text-right"}," İşlemler ",-1))])]),l("tbody",null,[(v(!0),g(P,null,Q(r(b),o=>(v(),g("tr",{key:o.id},[l("td",null,n(o.name),1),l("td",null,n(o.vendor?.label??"-"),1),l("td",null,n(o.account?.label??"-"),1),l("td",K,n(r(U)(o.amount)),1),l("td",null,n(e.$t("common.nthDay",{day:o.due_day})),1),l("td",null,n(o.period_label),1),l("td",null,[t(M,{size:"small",color:o.is_active?"success":"secondary",variant:"tonal"},{default:s(()=>[y(n(o.is_active?e.$t("common.active"):e.$t("common.passive")),1)]),_:2},1032,["color"])]),l("td",null,n(r(j)(o.last_generated_at)),1),l("td",W,[t(f,{icon:"",size:"small",variant:"text",to:`/templates/expense/${o.id}/edit`},{default:s(()=>[t(w,{icon:"ri-edit-line"})]),_:1},8,["to"]),t(f,{icon:"",size:"small",variant:"text",color:"error",loading:r(h)===o.id,disabled:r(h)===o.id,onClick:te=>N(o)},{default:s(()=>[t(w,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),r(b).length===0?(v(),g("tr",X,[l("td",Z,n(e.$t("common.noRecords")),1)])):B("",!0)])]),_:1}),t(E,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:s(()=>[l("span",ee,n(e.$t("common.totalRecords",{count:r(c).total})),1),t(I,{"model-value":r(c).current_page,length:r(c).last_page,"total-visible":7,"onUpdate:modelValue":p},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{_e as default};
