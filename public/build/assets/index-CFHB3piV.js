import{$ as x,T as k,x as v,p as T}from"./main-OjHNd2U9.js";import{f as j}from"./formatters-BEv4aA23.js";import{u as N,i as w}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as A,a as r}from"./VRow-Ba58lXtG.js";import{V as C}from"./VCard-9RfFlHpT.js";import{V as D}from"./VCardText-YweTyZzP.js";import{V as S}from"./VSelect-CMe3Xagq.js";import{V as I}from"./VTextField-CMxHKe9w.js";import{V as K}from"./VAlert-DafHPFjN.js";import{V as M}from"./VTable-ByowNMkP.js";import{V as E}from"./VChip-CnrRRXXG.js";import{V as P}from"./VPagination-Laqr3CkN.js";import{j as q,h as d,D as L,Q as _,R as F,S as t,q as a,y as l,a8 as m,u as i,O as n,ad as $,V as y,F as O,ab as R}from"./vendor-DfCbaU-T.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const H={class:"d-flex align-center justify-space-between mb-2"},Q={class:"d-flex gap-3 justify-end"},Y={class:"text-right"},G={class:"text-right"},J={key:0},W={class:"text-sm text-medium-emphasis"},be=q({__name:"index",setup(X){const{withAbort:h}=N(),g=d(!1),V=d(null),u=d(""),b=d([]),c=d({current_page:1,last_page:1,per_page:20,total:0}),o=d({scope:null,is_active:null,search:""}),p=async(f=1)=>{g.value=!0,u.value="";try{const e=await h(s=>x("/templates/aidat",{query:{page:f,scope:o.value.scope||void 0,is_active:o.value.is_active===null?void 0:o.value.is_active?1:0,search:o.value.search||void 0},signal:s}));b.value=e.data,c.value=e.meta}catch(e){if(w(e))return;u.value=k(e,"Aidat sablonlari alinamadi.")}finally{g.value=!1}},z=async()=>{await p(1)},B=async()=>{o.value={scope:null,is_active:null,search:""},await p(1)},U=async f=>{V.value=f.id,u.value="";try{await h(e=>x(`/templates/aidat/${f.id}`,{method:"DELETE",signal:e})),await p(c.value.current_page)}catch(e){if(w(e))return;u.value=k(e,"Aidat sablonu silinemedi.")}finally{V.value=null}};return L(()=>p(1)),(f,e)=>(_(),F(A,null,{default:t(()=>[a(r,{cols:"12"},{default:t(()=>[l("div",H,[e[4]||(e[4]=l("div",null,[l("h4",{class:"text-h4 mb-1"}," Aidat Sablonlari "),l("p",{class:"text-medium-emphasis mb-0"}," Aidat sablonlarini yonetin ")],-1)),a(v,{color:"primary","prepend-icon":"ri-add-line",to:"/templates/aidat/create"},{default:t(()=>[...e[3]||(e[3]=[m(" Yeni Sablon ",-1)])]),_:1})])]),_:1}),a(r,{cols:"12"},{default:t(()=>[a(C,null,{default:t(()=>[a(D,null,{default:t(()=>[a(A,null,{default:t(()=>[a(r,{cols:"12",md:"3"},{default:t(()=>[a(S,{modelValue:i(o).scope,"onUpdate:modelValue":e[0]||(e[0]=s=>i(o).scope=s),items:[{title:"Tum Daireler",value:"all"},{title:"Secili Daireler",value:"selected"}],label:"Kapsam",clearable:""},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",md:"3"},{default:t(()=>[a(S,{modelValue:i(o).is_active,"onUpdate:modelValue":e[1]||(e[1]=s=>i(o).is_active=s),items:[{title:"Aktif",value:!0},{title:"Pasif",value:!1}],label:"Durum",clearable:""},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",md:"6"},{default:t(()=>[a(I,{modelValue:i(o).search,"onUpdate:modelValue":e[2]||(e[2]=s=>i(o).search=s),label:"Arama",placeholder:"Sablon adi"},null,8,["modelValue"])]),_:1}),a(r,{cols:"12"},{default:t(()=>[l("div",Q,[a(v,{variant:"outlined",onClick:B},{default:t(()=>[...e[5]||(e[5]=[m(" Temizle ",-1)])]),_:1}),a(v,{color:"primary",onClick:z},{default:t(()=>[...e[6]||(e[6]=[m(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(u)?(_(),F(r,{key:0,cols:"12"},{default:t(()=>[a(K,{type:"error",variant:"tonal"},{default:t(()=>[m(n(i(u)),1)]),_:1})]),_:1})):$("",!0),a(r,{cols:"12"},{default:t(()=>[a(C,{loading:i(g)},{default:t(()=>[a(M,{density:"comfortable"},{default:t(()=>[e[8]||(e[8]=l("thead",null,[l("tr",null,[l("th",null,"Sablon"),l("th",null,"Hesap"),l("th",{class:"text-right"}," Tutar "),l("th",null,"Vade"),l("th",null,"Kapsam"),l("th",null,"Durum"),l("th",{class:"text-right"}," Islemler ")])],-1)),l("tbody",null,[(_(!0),y(O,null,R(i(b),s=>(_(),y("tr",{key:s.id},[l("td",null,n(s.name),1),l("td",null,n(s.account?.label??"-"),1),l("td",Y,n(i(j)(s.amount)),1),l("td",null,n(s.due_day)+". gun",1),l("td",null,[a(E,{size:"small",color:s.scope==="all"?"info":"warning",variant:"tonal"},{default:t(()=>[m(n(s.scope==="all"?"Tum Daireler":`${s.apartments_count} Daire`),1)]),_:2},1032,["color"])]),l("td",null,[a(E,{size:"small",color:s.is_active?"success":"secondary",variant:"tonal"},{default:t(()=>[m(n(s.is_active?"Aktif":"Pasif"),1)]),_:2},1032,["color"])]),l("td",G,[a(v,{icon:"",size:"small",variant:"text",to:`/templates/aidat/${s.id}/edit`},{default:t(()=>[a(T,{icon:"ri-edit-line"})]),_:1},8,["to"]),a(v,{icon:"",size:"small",variant:"text",color:"error",loading:i(V)===s.id,disabled:i(V)===s.id,onClick:Z=>U(s)},{default:t(()=>[a(T,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),i(b).length===0?(_(),y("tr",J,[...e[7]||(e[7]=[l("td",{colspan:"7",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):$("",!0)])]),_:1}),a(D,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:t(()=>[l("span",W,"Toplam "+n(i(c).total)+" kayit",1),a(P,{"model-value":i(c).current_page,length:i(c).last_page,"total-visible":7,"onUpdate:modelValue":p},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{be as default};
