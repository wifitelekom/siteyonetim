import{j as G,h as u,D as O,Q as R,R as w,S as o,ac as q,q as t,y as p,a8 as c,u as a,ag as Y,O as U,ad as H}from"./vendor-DfCbaU-T.js";import{u as I,i as $}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as D,T as A,x as V,U as L}from"./main-Btr01hqQ.js";import{V as P,r as f,p as Q}from"./VForm-D0fBkA3g.js";import{V as C,a as d}from"./VRow-CRn_xzm0.js";import{V as z}from"./VCard-BmPLTxO3.js";import{V as J}from"./VCardText-H2SttjXr.js";import{V as K}from"./VAlert-R8JWKysv.js";import{V as M}from"./VSelect-DhbvR9Z1.js";import{V as _}from"./VTextField-pVQuWnMO.js";import{V as W}from"./VTextarea-DCdZ-5SO.js";import"./vuetify-DGZOXKNZ.js";import"./VAvatar-96oJdN2D.js";import"./VList-BYpc2SqC.js";import"./VDivider-DEGojtwS.js";import"./VCheckboxBtn-DaQGgEjM.js";import"./VSelectionControl-ClrOpdq3.js";import"./VChip-DOrTqiUh.js";const X={class:"d-flex align-center justify-space-between mb-2"},Z={class:"d-flex justify-end gap-3"},be=G({__name:"create",setup(h){const{withAbort:b}=I(),T=q(),i=u(!1),v=u(!1),m=u(""),n=u({}),g=u([]),y=u([]),l=u({vendor_id:null,account_id:null,expense_date:"",due_date:"",amount:null,description:""}),x=u(null),k=[f()],N=[f()],S=[f()],B=[f()],E=[f(),Q()],F=async()=>{v.value=!0;try{const s=await b(e=>D("/expenses/meta",{signal:e}));g.value=s.data.vendors,y.value=s.data.accounts}catch(s){if($(s))return;m.value=A(s,"Form verileri alınamadı.")}finally{v.value=!1}},j=async()=>{if((await x.value?.validate())?.valid){i.value=!0,m.value="",n.value={};try{await b(e=>D("/expenses",{method:"POST",body:{vendor_id:l.value.vendor_id,account_id:l.value.account_id,expense_date:l.value.expense_date,due_date:l.value.due_date,amount:l.value.amount,description:l.value.description||null},signal:e})),await T.push("/expenses")}catch(e){if($(e))return;m.value=A(e,"Gider oluşturulamadı."),n.value=L(e)}finally{i.value=!1}}};return O(F),(s,e)=>(R(),w(C,null,{default:o(()=>[t(d,{cols:"12"},{default:o(()=>[p("div",X,[e[7]||(e[7]=p("div",null,[p("h4",{class:"text-h4 mb-1"}," Yeni Gider "),p("p",{class:"text-medium-emphasis mb-0"}," Yeni bir gider kaydı oluşturun ")],-1)),t(V,{variant:"outlined",to:"/expenses"},{default:o(()=>[...e[6]||(e[6]=[c(" Listeye Don ",-1)])]),_:1})])]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(z,{loading:a(v)||a(i)},{default:o(()=>[t(J,null,{default:o(()=>[t(P,{ref_key:"formRef",ref:x,onSubmit:Y(j,["prevent"])},{default:o(()=>[t(C,null,{default:o(()=>[a(m)?(R(),w(d,{key:0,cols:"12"},{default:o(()=>[t(K,{type:"error",variant:"tonal"},{default:o(()=>[c(U(a(m)),1)]),_:1})]),_:1})):H("",!0),t(d,{cols:"12",md:"6"},{default:o(()=>[t(M,{modelValue:a(l).vendor_id,"onUpdate:modelValue":e[0]||(e[0]=r=>a(l).vendor_id=r),items:a(g),"item-title":"label","item-value":"id",label:s.$t("common.vendor"),clearable:"",rules:k,"error-messages":a(n).vendor_id??[]},null,8,["modelValue","items","label","error-messages"])]),_:1}),t(d,{cols:"12",md:"6"},{default:o(()=>[t(M,{modelValue:a(l).account_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a(l).account_id=r),items:a(y),"item-title":"label","item-value":"id",label:"Gider Hesabi",rules:N,"error-messages":a(n).account_id??[]},null,8,["modelValue","items","error-messages"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(_,{modelValue:a(l).expense_date,"onUpdate:modelValue":e[2]||(e[2]=r=>a(l).expense_date=r),type:"date",label:s.$t("common.expenseDate"),rules:S,"error-messages":a(n).expense_date??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(_,{modelValue:a(l).due_date,"onUpdate:modelValue":e[3]||(e[3]=r=>a(l).due_date=r),type:"date",label:s.$t("common.dueDate"),rules:B,"error-messages":a(n).due_date??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(_,{modelValue:a(l).amount,"onUpdate:modelValue":e[4]||(e[4]=r=>a(l).amount=r),type:"number",step:"0.01",min:"0",label:s.$t("common.amount"),rules:E,"error-messages":a(n).amount??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(W,{modelValue:a(l).description,"onUpdate:modelValue":e[5]||(e[5]=r=>a(l).description=r),label:s.$t("common.description"),rows:"3","error-messages":a(n).description??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(d,{cols:"12"},{default:o(()=>[p("div",Z,[t(V,{variant:"outlined",to:"/expenses"},{default:o(()=>[...e[8]||(e[8]=[c(" Iptal ",-1)])]),_:1}),t(V,{color:"primary",type:"submit",loading:a(i),disabled:a(i)},{default:o(()=>[c(U(s.$t("common.save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{be as default};
