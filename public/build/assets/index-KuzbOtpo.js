import{u as R,i as w}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as C,T,x as c,q}from"./main-Btr01hqQ.js";import{a as E,f as b}from"./formatters-BEv4aA23.js";import{c as z,a as L}from"./statusHelpers-DSGXz7Bq.js";import{V as A,a as d}from"./VRow-CRn_xzm0.js";import{V as S}from"./VCard-BmPLTxO3.js";import{V as F}from"./VCardText-H2SttjXr.js";import{V as U}from"./VTextField-pVQuWnMO.js";import{V as B}from"./VSelect-DhbvR9Z1.js";import{V as P}from"./VAlert-R8JWKysv.js";import{V as I}from"./VTable-5XBH4x9y.js";import{V as K}from"./VChip-DOrTqiUh.js";import{V as Q}from"./VPagination-9yrd3TeG.js";import{j as Y,h as m,D as G,Q as f,R as D,S as s,q as a,y as e,O as n,a8 as u,u as l,ad as M,V as y,F as H,ab as J}from"./vendor-DfCbaU-T.js";import"./vuetify-DGZOXKNZ.js";import"./VAvatar-96oJdN2D.js";import"./VList-BYpc2SqC.js";import"./VDivider-DEGojtwS.js";import"./VCheckboxBtn-DaQGgEjM.js";import"./VSelectionControl-ClrOpdq3.js";const W={class:"d-flex align-center justify-space-between mb-2"},X={class:"text-medium-emphasis mb-0"},Z={class:"d-flex gap-2"},tt={class:"d-flex gap-3 justify-end"},et={class:"text-right"},at={class:"font-weight-medium"},lt={class:"text-caption text-medium-emphasis"},st={class:"text-caption text-medium-emphasis"},ot={class:"text-right"},rt={class:"text-right"},nt={class:"text-right"},it={class:"text-right"},dt={key:0},mt={colspan:"7",class:"text-center text-medium-emphasis py-6"},ut={class:"text-sm text-medium-emphasis"},Dt=Y({__name:"index",setup(pt){const _=m(!1),V=m(!1),p=m(""),g=m([]),k=m([]),x=m([]),h=m({current_page:1,last_page:1,per_page:15,total:0}),i=m({period:"",apartment_id:null,status:null,search:""}),{withAbort:$}=R(),j=async()=>{V.value=!0;try{const o=await $(t=>C("/charges/meta",{signal:t}));k.value=o.data.apartments}catch(o){if(w(o))return;p.value=T(o,"Filtre verileri alınamadı.")}finally{V.value=!1}},v=async(o=1)=>{_.value=!0,p.value="";try{const t=await $(r=>C("/charges",{query:{page:o,period:i.value.period||void 0,apartment_id:i.value.apartment_id||void 0,status:i.value.status||void 0,search:i.value.search||void 0},signal:r}));g.value=t.data,h.value=t.meta,x.value=t.filters.status}catch(t){if(w(t))return;p.value=T(t,"Tahakkuk listesi alınamadı.")}finally{_.value=!1}},N=async()=>{await v(1)},O=async()=>{i.value={period:"",apartment_id:null,status:null,search:""},await v(1)};return G(async()=>{await Promise.allSettled([j(),v(1)])}),(o,t)=>(f(),D(A,null,{default:s(()=>[a(d,{cols:"12"},{default:s(()=>[e("div",W,[e("div",null,[t[4]||(t[4]=e("h4",{class:"text-h4 mb-1"}," Tahakkuklar ",-1)),e("p",X,n(o.$t("pages.charges.indexSubtitle")),1)]),e("div",Z,[a(c,{variant:"outlined","prepend-icon":"ri-stack-line",to:"/charges/create-bulk"},{default:s(()=>[...t[5]||(t[5]=[u(" Toplu Tahakkuk ",-1)])]),_:1}),a(c,{color:"primary","prepend-icon":"ri-add-line",to:"/charges/create"},{default:s(()=>[...t[6]||(t[6]=[u(" Yeni Tahakkuk ",-1)])]),_:1})])])]),_:1}),a(d,{cols:"12"},{default:s(()=>[a(S,{loading:l(V)},{default:s(()=>[a(F,null,{default:s(()=>[a(A,null,{default:s(()=>[a(d,{cols:"12",md:"3"},{default:s(()=>[a(U,{modelValue:l(i).period,"onUpdate:modelValue":t[0]||(t[0]=r=>l(i).period=r),type:"month",label:o.$t("common.period")},null,8,["modelValue","label"])]),_:1}),a(d,{cols:"12",md:"3"},{default:s(()=>[a(B,{modelValue:l(i).apartment_id,"onUpdate:modelValue":t[1]||(t[1]=r=>l(i).apartment_id=r),items:l(k),"item-title":"label","item-value":"id",label:o.$t("common.apartment"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),a(d,{cols:"12",md:"3"},{default:s(()=>[a(B,{modelValue:l(i).status,"onUpdate:modelValue":t[2]||(t[2]=r=>l(i).status=r),items:l(x),"item-title":"label","item-value":"value",label:o.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),a(d,{cols:"12",md:"3"},{default:s(()=>[a(U,{modelValue:l(i).search,"onUpdate:modelValue":t[3]||(t[3]=r=>l(i).search=r),label:o.$t("common.search"),placeholder:o.$t("common.searchDescriptionOrApartment")},null,8,["modelValue","label","placeholder"])]),_:1}),a(d,{cols:"12"},{default:s(()=>[e("div",tt,[a(c,{variant:"outlined",onClick:O},{default:s(()=>[u(n(o.$t("common.clear")),1)]),_:1}),a(c,{color:"primary",onClick:N},{default:s(()=>[u(n(o.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),l(p)?(f(),D(d,{key:0,cols:"12"},{default:s(()=>[a(P,{type:"error",variant:"tonal"},{default:s(()=>[u(n(l(p)),1)]),_:1})]),_:1})):M("",!0),a(d,{cols:"12"},{default:s(()=>[a(S,{loading:l(_)},{default:s(()=>[a(I,{density:"comfortable"},{default:s(()=>[e("thead",null,[e("tr",null,[e("th",null,n(o.$t("common.apartment")),1),e("th",null,n(o.$t("common.periodAndDue")),1),t[7]||(t[7]=e("th",{class:"text-right"}," Tutar ",-1)),e("th",et,n(o.$t("common.paid")),1),t[8]||(t[8]=e("th",{class:"text-right"}," Kalan ",-1)),e("th",null,n(o.$t("common.status")),1),t[9]||(t[9]=e("th",{class:"text-right"}," İşlemler ",-1))])]),e("tbody",null,[(f(!0),y(H,null,J(l(g),r=>(f(),y("tr",{key:r.id},[e("td",null,[e("div",at,n(r.apartment?.label??"-"),1),e("div",lt,n(r.account?.name??"-"),1)]),e("td",null,[e("div",null,n(r.period),1),e("div",st,n(l(E)(r.due_date)),1)]),e("td",ot,n(l(b)(r.amount)),1),e("td",rt,n(l(b)(r.paid_amount)),1),e("td",nt,n(l(b)(r.remaining)),1),e("td",null,[a(K,{size:"small",color:l(z)(r.status),variant:"tonal"},{default:s(()=>[u(n(l(L)(r.status)),1)]),_:2},1032,["color"])]),e("td",it,[a(c,{icon:"",size:"small",variant:"text",to:`/charges/${r.id}`},{default:s(()=>[a(q,{icon:"ri-eye-line"})]),_:1},8,["to"])])]))),128)),l(g).length===0?(f(),y("tr",dt,[e("td",mt,n(o.$t("common.noRecords")),1)])):M("",!0)])]),_:1}),a(F,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:s(()=>[e("span",ut,n(o.$t("common.totalRecords",{count:l(h).total})),1),a(Q,{"model-value":l(h).current_page,length:l(h).last_page,"total-visible":7,"onUpdate:modelValue":v},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{Dt as default};
