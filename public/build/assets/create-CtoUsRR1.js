import{j as I,h as i,D as K,Q as v,R as b,S as s,ac as $,q as l,y as p,a8 as f,u as a,ag as G,O as H,ad as S}from"./vendor-DfCbaU-T.js";import{$ as N,T as k,x as _,U as L}from"./main-OjHNd2U9.js";import{V as P,r as c,p as Q}from"./VForm-CtC6ldpE.js";import{u as Y,i as C}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as M,a as u}from"./VRow-Ba58lXtG.js";import{V as J}from"./VCard-9RfFlHpT.js";import{V as W}from"./VCardText-YweTyZzP.js";import{V as X}from"./VAlert-DafHPFjN.js";import{V as g}from"./VTextField-CMxHKe9w.js";import{V as y}from"./VSelect-CMe3Xagq.js";import{V as Z}from"./VSwitch-XgqsY1US.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";import"./VChip-CnrRRXXG.js";const h={class:"d-flex align-center justify-space-between mb-2"},ee={class:"d-flex justify-end gap-3"},ye=I({__name:"create",setup(ae){const T=$(),{withAbort:A}=Y(),V=i(!1),d=i(!1),m=i(""),n=i({}),R=i([]),x=i([]),w=i([]),t=i({name:"",amount:null,due_day:15,account_id:null,scope:"all",apartment_ids:[],is_active:!0}),U=i(null),D=[c()],E=[c()],B=[c(),Q()],F=[c(),o=>{const e=Number(o);return!Number.isInteger(e)||e<1||e>28?"Vade gunu 1 ile 28 arasinda olmalidir.":!0}],O=[c()],j=[o=>t.value.scope!=="selected"||Array.isArray(o)&&o.length>0?!0:"En az bir daire seciniz."],q=async()=>{V.value=!0;try{const o=await A(e=>N("/templates/aidat/meta",{signal:e}));R.value=o.data.accounts,x.value=o.data.apartments,w.value=o.data.scopes}catch(o){if(C(o))return;m.value=k(o,"Form verileri alinamadi.")}finally{V.value=!1}},z=async()=>{if((await U.value?.validate())?.valid){d.value=!0,m.value="",n.value={};try{await A(e=>N("/templates/aidat",{method:"POST",body:{name:t.value.name,amount:t.value.amount,due_day:t.value.due_day,account_id:t.value.account_id,scope:t.value.scope,apartment_ids:t.value.scope==="selected"?t.value.apartment_ids:[],is_active:t.value.is_active},signal:e})),await T.push("/templates/aidat")}catch(e){if(C(e))return;m.value=k(e,"Aidat sablonu olusturulamadi."),n.value=L(e)}finally{d.value=!1}}};return K(q),(o,e)=>(v(),b(M,null,{default:s(()=>[l(u,{cols:"12"},{default:s(()=>[p("div",h,[e[8]||(e[8]=p("div",null,[p("h4",{class:"text-h4 mb-1"}," Yeni Aidat Sablonu "),p("p",{class:"text-medium-emphasis mb-0"}," Aidat sablon bilgilerini girin ")],-1)),l(_,{variant:"outlined",to:"/templates/aidat"},{default:s(()=>[...e[7]||(e[7]=[f(" Listeye Don ",-1)])]),_:1})])]),_:1}),l(u,{cols:"12"},{default:s(()=>[l(J,{loading:a(d)||a(V)},{default:s(()=>[l(W,null,{default:s(()=>[l(P,{ref_key:"formRef",ref:U,onSubmit:G(z,["prevent"])},{default:s(()=>[l(M,null,{default:s(()=>[a(m)?(v(),b(u,{key:0,cols:"12"},{default:s(()=>[l(X,{type:"error",variant:"tonal"},{default:s(()=>[f(H(a(m)),1)]),_:1})]),_:1})):S("",!0),l(u,{cols:"12",md:"6"},{default:s(()=>[l(g,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=r=>a(t).name=r),label:"Sablon Adi",rules:D,"error-messages":a(n).name??[]},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",md:"6"},{default:s(()=>[l(y,{modelValue:a(t).account_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a(t).account_id=r),items:a(R),"item-title":"label","item-value":"id",label:"Hesap",rules:E,"error-messages":a(n).account_id??[]},null,8,["modelValue","items","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l(g,{modelValue:a(t).amount,"onUpdate:modelValue":e[2]||(e[2]=r=>a(t).amount=r),type:"number",min:"0.01",step:"0.01",label:"Tutar",rules:B,"error-messages":a(n).amount??[]},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l(g,{modelValue:a(t).due_day,"onUpdate:modelValue":e[3]||(e[3]=r=>a(t).due_day=r),type:"number",min:"1",max:"28",label:"Vade Gunu",rules:F,"error-messages":a(n).due_day??[]},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l(y,{modelValue:a(t).scope,"onUpdate:modelValue":e[4]||(e[4]=r=>a(t).scope=r),items:a(w),"item-title":"label","item-value":"value",label:"Kapsam",rules:O,"error-messages":a(n).scope??[]},null,8,["modelValue","items","error-messages"])]),_:1}),a(t).scope==="selected"?(v(),b(u,{key:1,cols:"12"},{default:s(()=>[l(y,{modelValue:a(t).apartment_ids,"onUpdate:modelValue":e[5]||(e[5]=r=>a(t).apartment_ids=r),items:a(x),"item-title":"label","item-value":"id",label:"Daireler",multiple:"",chips:"","closable-chips":"",rules:j,"error-messages":a(n).apartment_ids??[]},null,8,["modelValue","items","error-messages"])]),_:1})):S("",!0),l(u,{cols:"12"},{default:s(()=>[l(Z,{modelValue:a(t).is_active,"onUpdate:modelValue":e[6]||(e[6]=r=>a(t).is_active=r),label:"Aktif",color:"primary"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:s(()=>[p("div",ee,[l(_,{variant:"outlined",to:"/templates/aidat"},{default:s(()=>[...e[9]||(e[9]=[f(" Iptal ",-1)])]),_:1}),l(_,{color:"primary",type:"submit",loading:a(d),disabled:a(d)},{default:s(()=>[...e[10]||(e[10]=[f(" Kaydet ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ye as default};
