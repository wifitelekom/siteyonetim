import{u as L}from"./useAbortOnUnmount-B_TyPYrd.js";import{e as N,$ as b,T as x,x as c,q as k}from"./main-DUODoQpR.js";import{V as R,a as d}from"./VRow-dBMGxjTF.js";import{V as T}from"./VCard-DEMyauu_.js";import{V as U}from"./VCardText-lEnvPJxp.js";import{V as q}from"./VSelect-BpDYXa0x.js";import{V as D}from"./VTextField-BgtisBQp.js";import{V as K}from"./VCheckbox-tAy4A4xc.js";import{V as O}from"./VAlert-DIbLZTVg.js";import{V as I}from"./VTable-CDiDVqFm.js";import{V as P}from"./VChip-CzUAJTHl.js";import{V as Q}from"./VPagination-Dp4qKX6V.js";import{j as w,h as u,D as G,Q as g,R as A,S as l,a0 as H,q as e,y as t,a8 as p,O as i,u as o,ad as S,V as $,F as J,ab as W}from"./vendor-qaEqcc9M.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const X={class:"d-flex align-center justify-space-between mb-2"},Y={class:"d-flex gap-3 justify-end"},Z={class:"text-caption text-medium-emphasis"},ee={class:"text-right"},le={key:0},te={colspan:"6",class:"text-center text-medium-emphasis py-6"},ae={class:"text-sm text-medium-emphasis"},Ce=w({__name:"index",setup(se){L();const{user:E}=N(),V=u(!1),y=u(!1),h=u(null),m=u(""),_=u([]),C=u([]),f=u({current_page:1,last_page:1,per_page:20,total:0}),r=u({role:null,search:"",archived:!1}),F=async()=>{y.value=!0;try{const n=await b("/users/meta");C.value=n.data.roles}catch(n){m.value=x(n,"Filtre verileri alınamadı.")}finally{y.value=!1}},v=async(n=1)=>{V.value=!0,m.value="";try{const a=await b("/users",{query:{page:n,role:r.value.role||void 0,search:r.value.search||void 0,archived:r.value.archived?"1":"0"}});_.value=a.data,f.value=a.meta}catch(a){m.value=x(a,"Kullanıcı listesi alınamadı.")}finally{V.value=!1}},B=async()=>{await v(1)},M=async()=>{r.value={role:null,search:"",archived:!1},await v(1)},j=async n=>{h.value=n.id,m.value="";try{await b(`/users/${n.id}`,{method:"DELETE"}),await v(f.value.current_page)}catch(a){m.value=x(a,"Kullanıcı silinemedi.")}finally{h.value=null}};return G(async()=>{await Promise.allSettled([F(),v(1)])}),(n,a)=>{const z=H("RouterLink");return g(),A(R,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[t("div",X,[a[3]||(a[3]=t("div",null,[t("h4",{class:"text-h4 mb-1"}," Kullanıcılar "),t("p",{class:"text-medium-emphasis mb-0"}," Site kullanıcılarini yönetin ")],-1)),e(c,{color:"primary","prepend-icon":"ri-user-add-line",to:"/management/users/create"},{default:l(()=>[p(i(n.$t("pages.users.newTitle")),1)]),_:1})])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(T,{loading:o(y)},{default:l(()=>[e(U,null,{default:l(()=>[e(R,null,{default:l(()=>[e(d,{cols:"12",md:"3"},{default:l(()=>[e(q,{modelValue:o(r).role,"onUpdate:modelValue":a[0]||(a[0]=s=>o(r).role=s),items:o(C),"item-title":"label","item-value":"value",label:"Rol",clearable:""},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",md:"6"},{default:l(()=>[e(D,{modelValue:o(r).search,"onUpdate:modelValue":a[1]||(a[1]=s=>o(r).search=s),label:n.$t("common.search"),placeholder:"Ad, e-posta, telefon, TC"},null,8,["modelValue","label"])]),_:1}),e(d,{cols:"12",md:"3",class:"d-flex align-center"},{default:l(()=>[e(K,{modelValue:o(r).archived,"onUpdate:modelValue":a[2]||(a[2]=s=>o(r).archived=s),label:"Arsivlenmisleri goster","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[t("div",Y,[e(c,{variant:"outlined",onClick:M},{default:l(()=>[p(i(n.$t("common.clear")),1)]),_:1}),e(c,{color:"primary",onClick:B},{default:l(()=>[p(i(n.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),o(m)?(g(),A(d,{key:0,cols:"12"},{default:l(()=>[e(O,{type:"error",variant:"tonal"},{default:l(()=>[p(i(o(m)),1)]),_:1})]),_:1})):S("",!0),e(d,{cols:"12"},{default:l(()=>[e(T,{loading:o(V)},{default:l(()=>[e(I,{density:"comfortable"},{default:l(()=>[t("thead",null,[t("tr",null,[a[4]||(a[4]=t("th",null,"Ad Soyad",-1)),a[5]||(a[5]=t("th",null,"E-posta",-1)),t("th",null,i(n.$t("common.contact")),1),a[6]||(a[6]=t("th",null,"Rol",-1)),t("th",null,i(n.$t("common.apartment")),1),a[7]||(a[7]=t("th",{class:"text-right"}," İşlemler ",-1))])]),t("tbody",null,[(g(!0),$(J,null,W(o(_),s=>(g(),$("tr",{key:s.id},[t("td",null,[e(z,{to:`/management/users/${s.id}`,class:"font-weight-medium text-primary text-decoration-underline d-inline-block"},{default:l(()=>[p(i(s.name),1)]),_:2},1032,["to"])]),t("td",null,i(s.email||"-"),1),t("td",null,[t("div",null,i(s.phone||"-"),1),t("div",Z,i(s.tc_kimlik||"-"),1)]),t("td",null,[e(P,{size:"small",color:"primary",variant:"tonal"},{default:l(()=>[p(i(s.role_label),1)]),_:2},1024)]),t("td",null,i(s.apartment_count),1),t("td",ee,[e(c,{icon:"",size:"small",variant:"text",to:`/management/users/${s.id}`},{default:l(()=>[e(k,{icon:"ri-eye-line"})]),_:1},8,["to"]),e(c,{icon:"",size:"small",variant:"text",to:`/management/users/${s.id}/edit`},{default:l(()=>[e(k,{icon:"ri-edit-line"})]),_:1},8,["to"]),e(c,{icon:"",size:"small",variant:"text",color:"error",disabled:o(E)?.id===s.id||o(h)===s.id,loading:o(h)===s.id,onClick:oe=>j(s)},{default:l(()=>[e(k,{icon:"ri-delete-bin-line"})]),_:1},8,["disabled","loading","onClick"])])]))),128)),o(_).length===0?(g(),$("tr",le,[t("td",te,i(n.$t("common.noRecords")),1)])):S("",!0)])]),_:1}),e(U,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[t("span",ae,i(n.$t("common.totalRecords",{count:o(f).total})),1),e(Q,{"model-value":o(f).current_page,length:o(f).last_page,"total-visible":7,"onUpdate:modelValue":v},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}});export{Ce as default};
