import{j as ee,h as n,D as le,Q as g,R as D,S as a,q as l,y as r,a8 as c,u as t,O as b,ad as K,V as E,F as ae,ab as te,H as se,ag as oe}from"./vendor-DfCbaU-T.js";import{u as re}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as _,T as h,x as v,p as O,V as ne,U as ie}from"./main-OjHNd2U9.js";import{V as ue,r as F}from"./VForm-CtC6ldpE.js";import{a as u,V as R}from"./VRow-Ba58lXtG.js";import{V as S,d as de}from"./VCard-9RfFlHpT.js";import{V as $}from"./VCardText-YweTyZzP.js";import{V as j}from"./VSelect-CMe3Xagq.js";import{V as z}from"./VTextField-CMxHKe9w.js";import{V as me}from"./VAlert-DafHPFjN.js";import{V as pe}from"./VTable-ByowNMkP.js";import{V as fe}from"./VChip-CnrRRXXG.js";import{V as ce}from"./VPagination-Laqr3CkN.js";import{V as ve}from"./VDialog-BQJ2uzM5.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const ye={class:"d-flex align-center justify-space-between mb-2"},Ve={class:"d-flex gap-3 justify-end"},ge={class:"text-right"},be={key:0},_e={class:"text-sm text-medium-emphasis"},Ie=ee({__name:"index",setup(xe){re();const T=n(!1),H=n(!1),x=n(!1),w=n(null),d=n(""),m=n({}),A=n([]),U=n([]),y=n({current_page:1,last_page:1,per_page:20,total:0}),p=n({type:null,search:""}),f=n(!1),C=n(!1),k=n(null),i=n({code:"",name:"",type:"income"}),M=n(null),I=[F()],N=[F()],P=[F()],q=o=>o==="income"?"success":o==="expense"?"error":o==="asset"?"primary":"warning",L=async()=>{H.value=!0;try{const o=await _("/accounts/meta");U.value=o.data.types}catch(o){d.value=h(o,"Hesap turleri alinamadi.")}finally{H.value=!1}},V=async(o=1)=>{T.value=!0,d.value="";try{const e=await _("/accounts",{query:{page:o,type:p.value.type||void 0,search:p.value.search||void 0}});A.value=e.data,y.value=e.meta}catch(e){d.value=h(e,"Hesaplar alinamadi.")}finally{T.value=!1}},Y=()=>{C.value=!1,k.value=null,i.value={code:"",name:"",type:"income"},m.value={}},G=()=>{Y(),f.value=!0},Q=o=>{C.value=!0,k.value=o.id,i.value={code:o.code,name:o.name,type:o.type},m.value={},f.value=!0},B=async()=>{if((await M.value?.validate())?.valid){x.value=!0,d.value="",m.value={};try{C.value&&k.value?await _(`/accounts/${k.value}`,{method:"PUT",body:i.value}):await _("/accounts",{method:"POST",body:i.value}),f.value=!1,await V(y.value.current_page)}catch(e){d.value=h(e,"Hesap kaydedilemedi."),m.value=ie(e)}finally{x.value=!1}}},J=async o=>{w.value=o.id,d.value="";try{await _(`/accounts/${o.id}`,{method:"DELETE"}),await V(y.value.current_page)}catch(e){d.value=h(e,"Hesap silinemedi.")}finally{w.value=null}},W=async()=>{await V(1)},X=async()=>{p.value={type:null,search:""},await V(1)};return le(async()=>{await Promise.allSettled([L(),V(1)])}),(o,e)=>(g(),D(R,null,{default:a(()=>[l(u,{cols:"12"},{default:a(()=>[r("div",ye,[e[8]||(e[8]=r("div",null,[r("h4",{class:"text-h4 mb-1"}," Hesaplar "),r("p",{class:"text-medium-emphasis mb-0"}," Gelir, gider ve diger hesap plani ")],-1)),l(v,{color:"primary","prepend-icon":"ri-add-line",onClick:G},{default:a(()=>[...e[7]||(e[7]=[c(" Yeni Hesap ",-1)])]),_:1})])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(S,{loading:t(H)},{default:a(()=>[l($,null,{default:a(()=>[l(R,null,{default:a(()=>[l(u,{cols:"12",md:"4"},{default:a(()=>[l(j,{modelValue:t(p).type,"onUpdate:modelValue":e[0]||(e[0]=s=>t(p).type=s),items:t(U),"item-title":"label","item-value":"value",label:"Tur",clearable:""},null,8,["modelValue","items"])]),_:1}),l(u,{cols:"12",md:"8"},{default:a(()=>[l(z,{modelValue:t(p).search,"onUpdate:modelValue":e[1]||(e[1]=s=>t(p).search=s),label:"Arama",placeholder:"Kod veya hesap adi"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[r("div",Ve,[l(v,{variant:"outlined",onClick:X},{default:a(()=>[...e[9]||(e[9]=[c(" Temizle ",-1)])]),_:1}),l(v,{color:"primary",onClick:W},{default:a(()=>[...e[10]||(e[10]=[c(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),t(d)?(g(),D(u,{key:0,cols:"12"},{default:a(()=>[l(me,{type:"error",variant:"tonal"},{default:a(()=>[c(b(t(d)),1)]),_:1})]),_:1})):K("",!0),l(u,{cols:"12"},{default:a(()=>[l(S,{loading:t(T)},{default:a(()=>[l(pe,{density:"comfortable"},{default:a(()=>[e[12]||(e[12]=r("thead",null,[r("tr",null,[r("th",null,"Kod"),r("th",null,"Hesap Adi"),r("th",null,"Tur"),r("th",{class:"text-right"},"Islemler")])],-1)),r("tbody",null,[(g(!0),E(ae,null,te(t(A),s=>(g(),E("tr",{key:s.id},[r("td",null,[r("code",null,b(s.code),1)]),r("td",null,b(s.name),1),r("td",null,[l(fe,{size:"small",color:q(s.type),variant:"tonal"},{default:a(()=>[c(b(s.type_label),1)]),_:2},1032,["color"])]),r("td",ge,[l(v,{icon:"",size:"small",variant:"text",onClick:Z=>Q(s)},{default:a(()=>[l(O,{icon:"ri-edit-line"})]),_:1},8,["onClick"]),l(v,{icon:"",size:"small",variant:"text",color:"error",loading:t(w)===s.id,disabled:t(w)===s.id,onClick:Z=>J(s)},{default:a(()=>[l(O,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),t(A).length===0?(g(),E("tr",be,[...e[11]||(e[11]=[r("td",{colspan:"4",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):K("",!0)])]),_:1}),l($,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:a(()=>[r("span",_e,"Toplam "+b(t(y).total)+" kayit",1),l(ce,{"model-value":t(y).current_page,length:t(y).last_page,"total-visible":7,"onUpdate:modelValue":V},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1}),l(ve,{modelValue:t(f),"onUpdate:modelValue":e[6]||(e[6]=s=>se(f)?f.value=s:null),"max-width":"560"},{default:a(()=>[l(S,{title:t(C)?"Hesap Duzenle":"Yeni Hesap"},{default:a(()=>[l($,null,{default:a(()=>[l(ue,{ref_key:"formRef",ref:M,onSubmit:oe(B,["prevent"])},{default:a(()=>[l(R,null,{default:a(()=>[l(u,{cols:"12"},{default:a(()=>[l(z,{modelValue:t(i).code,"onUpdate:modelValue":e[2]||(e[2]=s=>t(i).code=s),label:"Hesap Kodu",rules:I,"error-messages":t(m).code??[]},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(z,{modelValue:t(i).name,"onUpdate:modelValue":e[3]||(e[3]=s=>t(i).name=s),label:"Hesap Adi",rules:N,"error-messages":t(m).name??[]},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(j,{modelValue:t(i).type,"onUpdate:modelValue":e[4]||(e[4]=s=>t(i).type=s),items:t(U),"item-title":"label","item-value":"value",label:"Tur",rules:P,"error-messages":t(m).type??[]},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(de,{class:"px-6 pb-4"},{default:a(()=>[l(ne),l(v,{variant:"outlined",onClick:e[5]||(e[5]=s=>f.value=!1)},{default:a(()=>[...e[13]||(e[13]=[c(" Vazgec ",-1)])]),_:1}),l(v,{color:"primary",loading:t(x),disabled:t(x),onClick:B},{default:a(()=>[...e[14]||(e[14]=[c(" Kaydet ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}))}});export{Ie as default};
