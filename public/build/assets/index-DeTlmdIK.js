import{j as le,h as r,D as te,Q as b,R as M,S as t,q as e,y as n,O as i,a8 as c,u as o,ad as D,V as B,F as oe,ab as se,H as ne,ag as ie}from"./vendor-qaEqcc9M.js";import{u as re}from"./useAbortOnUnmount-B_TyPYrd.js";import{$ as h,T as w,x as p,q as S,V as ue,U as de}from"./main-DUODoQpR.js";import{f as O}from"./formatters-BEv4aA23.js";import{V as me,r as P}from"./VForm-AfrkaUJk.js";import{V as E,a as d}from"./VRow-dBMGxjTF.js";import{V as F,d as ce}from"./VCard-DEMyauu_.js";import{V as N}from"./VCardText-lEnvPJxp.js";import{V as j}from"./VSelect-BpDYXa0x.js";import{V as T}from"./VTextField-BgtisBQp.js";import{V as pe}from"./VAlert-DIbLZTVg.js";import{V as fe}from"./VTable-CDiDVqFm.js";import{V as q}from"./VChip-CzUAJTHl.js";import{V as ve}from"./VPagination-Dp4qKX6V.js";import{V as ye}from"./VDialog-8MtGyTgn.js";import{V as ge}from"./VSwitch-C2gHzlAV.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const Ve={class:"d-flex align-center justify-space-between mb-2"},be={class:"text-medium-emphasis mb-0"},he={class:"d-flex gap-3 justify-end"},_e={class:"font-weight-medium"},$e={class:"text-right"},Ce={class:"text-right font-weight-medium"},ke={class:"text-right"},we={key:0},xe={colspan:"6",class:"text-center text-medium-emphasis py-6"},Ae={class:"text-sm text-medium-emphasis"},We=le({__name:"index",setup(Re){re();const x=r(!1),A=r(!1),_=r(!1),$=r(null),m=r(""),f=r({}),R=r([]),U=r([]),g=r({current_page:1,last_page:1,per_page:20,total:0}),v=r({type:null,search:""}),y=r(!1),C=r(!1),k=r(null),u=r({name:"",type:"cash",opening_balance:0,is_active:!0}),z=r(null),I=[P()],K=[P()],L=[a=>{const l=Number(a);return Number.isFinite(l)&&l>=0?!0:"Sifir veya daha buyuk bir deger giriniz."}],Y=a=>a==="cash"?"success":"primary",G=async()=>{A.value=!0;try{const a=await h("/cash-accounts/meta");U.value=a.data.types}catch(a){m.value=w(a,"Hesap turleri alınamadı.")}finally{A.value=!1}},V=async(a=1)=>{x.value=!0,m.value="";try{const l=await h("/cash-accounts",{query:{page:a,type:v.value.type||void 0,search:v.value.search||void 0}});R.value=l.data,g.value=l.meta}catch(l){m.value=w(l,"Kasa/Banka hesapları alınamadı.")}finally{x.value=!1}},Q=()=>{C.value=!1,k.value=null,u.value={name:"",type:"cash",opening_balance:0,is_active:!0},f.value={}},J=()=>{Q(),y.value=!0},W=a=>{C.value=!0,k.value=a.id,u.value={name:a.name,type:a.type,opening_balance:Number(a.opening_balance),is_active:a.is_active},f.value={},y.value=!0},H=async()=>{if((await z.value?.validate())?.valid){_.value=!0,m.value="",f.value={};try{C.value&&k.value?await h(`/cash-accounts/${k.value}`,{method:"PUT",body:u.value}):await h("/cash-accounts",{method:"POST",body:u.value}),y.value=!1,await V(g.value.current_page)}catch(l){m.value=w(l,"Hesap kaydedilemedi."),f.value=de(l)}finally{_.value=!1}}},X=async a=>{$.value=a.id,m.value="";try{await h(`/cash-accounts/${a.id}`,{method:"DELETE"}),await V(g.value.current_page)}catch(l){m.value=w(l,"Hesap silinemedi.")}finally{$.value=null}},Z=async()=>{await V(1)},ee=async()=>{v.value={type:null,search:""},await V(1)};return te(async()=>{await Promise.allSettled([G(),V(1)])}),(a,l)=>(b(),M(E,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[n("div",Ve,[n("div",null,[l[8]||(l[8]=n("h4",{class:"text-h4 mb-1"}," Kasa/Banka ",-1)),n("p",be,i(a.$t("pages.cashAccounts.indexSubtitle")),1)]),e(p,{color:"primary","prepend-icon":"ri-add-line",onClick:J},{default:t(()=>[...l[9]||(l[9]=[c(" Yeni Hesap ",-1)])]),_:1})])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(F,{loading:o(A)},{default:t(()=>[e(N,null,{default:t(()=>[e(E,null,{default:t(()=>[e(d,{cols:"12",md:"4"},{default:t(()=>[e(j,{modelValue:o(v).type,"onUpdate:modelValue":l[0]||(l[0]=s=>o(v).type=s),items:o(U),"item-title":"label","item-value":"value",label:a.$t("common.type"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),e(d,{cols:"12",md:"8"},{default:t(()=>[e(T,{modelValue:o(v).search,"onUpdate:modelValue":l[1]||(l[1]=s=>o(v).search=s),label:a.$t("common.search"),placeholder:a.$t("common.accountNamePlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[n("div",he,[e(p,{variant:"outlined",onClick:ee},{default:t(()=>[c(i(a.$t("common.clear")),1)]),_:1}),e(p,{color:"primary",onClick:Z},{default:t(()=>[c(i(a.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),o(m)?(b(),M(d,{key:0,cols:"12"},{default:t(()=>[e(pe,{type:"error",variant:"tonal"},{default:t(()=>[c(i(o(m)),1)]),_:1})]),_:1})):D("",!0),e(d,{cols:"12"},{default:t(()=>[e(F,{loading:o(x)},{default:t(()=>[e(fe,{density:"comfortable"},{default:t(()=>[n("thead",null,[n("tr",null,[n("th",null,i(a.$t("common.account")),1),n("th",null,i(a.$t("common.type")),1),l[10]||(l[10]=n("th",{class:"text-right"}," Açılış ",-1)),l[11]||(l[11]=n("th",{class:"text-right"}," Guncel Bakiye ",-1)),n("th",null,i(a.$t("common.status")),1),l[12]||(l[12]=n("th",{class:"text-right"}," İşlemler ",-1))])]),n("tbody",null,[(b(!0),B(oe,null,se(o(R),s=>(b(),B("tr",{key:s.id},[n("td",null,[n("div",_e,i(s.name),1)]),n("td",null,[e(q,{size:"small",color:Y(s.type),variant:"tonal"},{default:t(()=>[c(i(s.type_label),1)]),_:2},1032,["color"])]),n("td",$e,i(o(O)(s.opening_balance)),1),n("td",Ce,i(o(O)(s.balance)),1),n("td",null,[e(q,{size:"small",color:s.is_active?"success":"secondary",variant:"tonal"},{default:t(()=>[c(i(s.is_active?a.$t("common.active"):a.$t("common.passive")),1)]),_:2},1032,["color"])]),n("td",ke,[e(p,{icon:"",size:"small",variant:"text",to:`/cash-accounts/${s.id}/statement`},{default:t(()=>[e(S,{icon:"ri-file-chart-line"})]),_:1},8,["to"]),e(p,{icon:"",size:"small",variant:"text",onClick:ae=>W(s)},{default:t(()=>[e(S,{icon:"ri-edit-line"})]),_:1},8,["onClick"]),e(p,{icon:"",size:"small",variant:"text",color:"error",loading:o($)===s.id,disabled:o($)===s.id,onClick:ae=>X(s)},{default:t(()=>[e(S,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),o(R).length===0?(b(),B("tr",we,[n("td",xe,i(a.$t("common.noRecords")),1)])):D("",!0)])]),_:1}),e(N,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:t(()=>[n("span",Ae,i(a.$t("common.totalRecords",{count:o(g).total})),1),e(ve,{"model-value":o(g).current_page,length:o(g).last_page,"total-visible":7,"onUpdate:modelValue":V},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1}),e(ye,{modelValue:o(y),"onUpdate:modelValue":l[7]||(l[7]=s=>ne(y)?y.value=s:null),"max-width":"560"},{default:t(()=>[e(F,{title:o(C)?"Hesap Düzenle":"Yeni Hesap"},{default:t(()=>[e(N,null,{default:t(()=>[e(me,{ref_key:"formRef",ref:z,onSubmit:ie(H,["prevent"])},{default:t(()=>[e(E,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(T,{modelValue:o(u).name,"onUpdate:modelValue":l[2]||(l[2]=s=>o(u).name=s),label:a.$t("common.accountName"),rules:I,"error-messages":o(f).name??[]},null,8,["modelValue","label","error-messages"])]),_:1}),e(d,{cols:"12",md:"6"},{default:t(()=>[e(j,{modelValue:o(u).type,"onUpdate:modelValue":l[3]||(l[3]=s=>o(u).type=s),items:o(U),"item-title":"label","item-value":"value",label:a.$t("common.type"),rules:K,"error-messages":o(f).type??[]},null,8,["modelValue","items","label","error-messages"])]),_:1}),e(d,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:o(u).opening_balance,"onUpdate:modelValue":l[4]||(l[4]=s=>o(u).opening_balance=s),type:"number",min:"0",step:"0.01",label:a.$t("common.openingBalance"),rules:L,"error-messages":o(f).opening_balance??[]},null,8,["modelValue","label","error-messages"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(ge,{modelValue:o(u).is_active,"onUpdate:modelValue":l[5]||(l[5]=s=>o(u).is_active=s),label:a.$t("common.active"),color:"primary"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(ce,{class:"px-6 pb-4"},{default:t(()=>[e(ue),e(p,{variant:"outlined",onClick:l[6]||(l[6]=s=>y.value=!1)},{default:t(()=>[c(i(a.$t("common.cancel")),1)]),_:1}),e(p,{color:"primary",loading:o(_),disabled:o(_),onClick:H},{default:t(()=>[c(i(a.$t("common.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}))}});export{We as default};
