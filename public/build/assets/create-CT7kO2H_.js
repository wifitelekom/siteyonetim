import{j as L,h as m,f as U,D as O,Q as g,R as Y,S as r,ac as I,q as l,y as u,a8 as V,u as a,ag as $,O as w,ad as k,v as Q,V as G,F as H}from"./vendor-DfCbaU-T.js";import{e as J,$ as N,T as M,x as b,U as K}from"./main-OjHNd2U9.js";import{V as W,r as y,e as X,m as Z,b as h}from"./VForm-CtC6ldpE.js";import{V as T,a as i}from"./VRow-Ba58lXtG.js";import{V as ee}from"./VCard-9RfFlHpT.js";import{V as ae}from"./VCardText-YweTyZzP.js";import{V as le}from"./VAlert-DafHPFjN.js";import{V as f}from"./VTextField-CMxHKe9w.js";import{V as se}from"./VTextarea-CHmrCRFp.js";import{V as re}from"./VSwitch-XgqsY1US.js";import{V as oe}from"./VDivider-CUijZXd4.js";import{V as te}from"./VSelect-CMe3Xagq.js";import{a as ie}from"./VList-B1ov9hmg.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VSelectionControl-Ck2LTPqY.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VChip-CnrRRXXG.js";const ne={class:"d-flex align-center justify-space-between mb-2"},de={class:"d-flex justify-end gap-3"},Ne=L({__name:"create",setup(ue){const S=I(),x=J(),p=m(!1),v=m(!1),_=m(""),n=m({}),R=m([]),s=m({name:"",phone:"",tax_no:"",address:"",is_active:!0,admin_user_id:null,admin_name:"",admin_email:"",admin_password:"",admin_password_confirmation:""}),A=m(null),B=U(()=>x.can("sites.manage")),d=U(()=>!s.value.admin_user_id),c=(t,e)=>d.value?y(e)(t):!0,C=[y()],E=[t=>c(t,"Yonetici adi zorunludur.")],F=[t=>{if(!d.value)return!0;const e=y("Yonetici e-posta zorunludur.")(t);return e!==!0?e:X()(t)}],q=[t=>c(t,"Yonetici sifresi zorunludur."),t=>d.value?Z(8)(t):!0],z=[t=>c(t,"Sifre tekrar zorunludur."),t=>d.value?h(()=>s.value.admin_password,"Sifreler eslesmiyor.")(t):!0],D=async()=>{v.value=!0;try{const t=await N("/super/sites/meta");R.value=t.data.available_admins}catch(t){_.value=M(t,"Yonetici listesi alinamadi.")}finally{v.value=!1}},P=async()=>{if((await A.value?.validate())?.valid){p.value=!0,_.value="",n.value={};try{await N("/super/sites",{method:"POST",body:{name:s.value.name,phone:s.value.phone||null,tax_no:s.value.tax_no||null,address:s.value.address||null,is_active:s.value.is_active,admin_user_id:s.value.admin_user_id||null,admin_name:d.value?s.value.admin_name:null,admin_email:d.value?s.value.admin_email:null,admin_password:d.value?s.value.admin_password:null,admin_password_confirmation:d.value?s.value.admin_password_confirmation:null}}),await S.push("/super/sites")}catch(e){_.value=M(e,"Site olusturulamadi."),n.value=K(e)}finally{p.value=!1}}};return O(async()=>{if(await x.ensureSession(),!B.value){await S.replace("/");return}await D()}),(t,e)=>(g(),Y(T,null,{default:r(()=>[l(i,{cols:"12"},{default:r(()=>[u("div",ne,[e[11]||(e[11]=u("div",null,[u("h4",{class:"text-h4 mb-1"}," Yeni Site "),u("p",{class:"text-medium-emphasis mb-0"}," Site ve yonetici bilgilerini girin ")],-1)),l(b,{variant:"outlined",to:"/super/sites"},{default:r(()=>[...e[10]||(e[10]=[V(" Listeye Don ",-1)])]),_:1})])]),_:1}),l(i,{cols:"12"},{default:r(()=>[l(ee,{loading:a(p)||a(v)},{default:r(()=>[l(ae,null,{default:r(()=>[l(W,{ref_key:"formRef",ref:A,onSubmit:$(P,["prevent"])},{default:r(()=>[l(T,null,{default:r(()=>[a(_)?(g(),Y(i,{key:0,cols:"12"},{default:r(()=>[l(le,{type:"error",variant:"tonal"},{default:r(()=>[V(w(a(_)),1)]),_:1})]),_:1})):k("",!0),l(i,{cols:"12"},{default:r(()=>[...e[12]||(e[12]=[u("h6",{class:"text-h6 mb-2"}," Site Bilgileri ",-1)])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(s).name=o),label:"Site Adi",rules:C,"error-messages":a(n).name??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).phone,"onUpdate:modelValue":e[1]||(e[1]=o=>a(s).phone=o),label:"Telefon","error-messages":a(n).phone??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).tax_no,"onUpdate:modelValue":e[2]||(e[2]=o=>a(s).tax_no=o),label:"Vergi No","error-messages":a(n).tax_no??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12"},{default:r(()=>[l(se,{modelValue:a(s).address,"onUpdate:modelValue":e[3]||(e[3]=o=>a(s).address=o),label:"Adres",rows:"3","error-messages":a(n).address??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12"},{default:r(()=>[l(re,{modelValue:a(s).is_active,"onUpdate:modelValue":e[4]||(e[4]=o=>a(s).is_active=o),label:"Aktif",color:"primary"},null,8,["modelValue"])]),_:1}),l(i,{cols:"12"},{default:r(()=>[l(oe)]),_:1}),l(i,{cols:"12"},{default:r(()=>[...e[13]||(e[13]=[u("h6",{class:"text-h6 mb-2"}," Site Yonetici Bilgileri ",-1)])]),_:1}),l(i,{cols:"12"},{default:r(()=>[l(te,{modelValue:a(s).admin_user_id,"onUpdate:modelValue":e[5]||(e[5]=o=>a(s).admin_user_id=o),items:a(R),"item-title":"name","item-value":"id",label:"Mevcut Yonetici Sec (opsiyonel)",clearable:"","error-messages":a(n).admin_user_id??[]},{item:r(({props:o,item:j})=>[l(ie,Q(o,{subtitle:j.raw.email||"-"}),null,16,["subtitle"])]),selection:r(({item:o})=>[u("span",null,w(o.raw.name)+" - "+w(o.raw.email||"-"),1)]),_:1},8,["modelValue","items","error-messages"])]),_:1}),a(d)?(g(),G(H,{key:1},[l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).admin_name,"onUpdate:modelValue":e[6]||(e[6]=o=>a(s).admin_name=o),label:"Yonetici Ad Soyad",rules:E,"error-messages":a(n).admin_name??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).admin_email,"onUpdate:modelValue":e[7]||(e[7]=o=>a(s).admin_email=o),type:"email",label:"Yonetici E-posta",rules:F,"error-messages":a(n).admin_email??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).admin_password,"onUpdate:modelValue":e[8]||(e[8]=o=>a(s).admin_password=o),type:"password",label:"Yonetici Sifre",rules:q,"error-messages":a(n).admin_password??[]},null,8,["modelValue","error-messages"])]),_:1}),l(i,{cols:"12",md:"6"},{default:r(()=>[l(f,{modelValue:a(s).admin_password_confirmation,"onUpdate:modelValue":e[9]||(e[9]=o=>a(s).admin_password_confirmation=o),type:"password",label:"Sifre Tekrar",rules:z,"error-messages":a(n).admin_password_confirmation??[]},null,8,["modelValue","error-messages"])]),_:1})],64)):k("",!0),l(i,{cols:"12"},{default:r(()=>[u("div",de,[l(b,{variant:"outlined",to:"/super/sites"},{default:r(()=>[...e[14]||(e[14]=[V(" Iptal ",-1)])]),_:1}),l(b,{color:"primary",type:"submit",loading:a(p),disabled:a(p)},{default:r(()=>[...e[15]||(e[15]=[V(" Siteyi Olustur ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{Ne as default};
