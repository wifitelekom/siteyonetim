import{u as z}from"./useAbortOnUnmount-D2zdVzb9.js";import{e as D,$ as x,T as b,x as f,p as T}from"./main-OjHNd2U9.js";import{V as A,a as m}from"./VRow-Ba58lXtG.js";import{V as F}from"./VCard-9RfFlHpT.js";import{V as S}from"./VCardText-YweTyZzP.js";import{V as I}from"./VSelect-CMe3Xagq.js";import{V as N}from"./VTextField-CMxHKe9w.js";import{V as R}from"./VAlert-DafHPFjN.js";import{V as O}from"./VTable-ByowNMkP.js";import{V as q}from"./VChip-CnrRRXXG.js";import{V as L}from"./VPagination-Laqr3CkN.js";import{j as P,h as n,D as w,Q as v,R as U,S as a,q as e,y as t,a8 as _,u as s,O as r,ad as B,V as k,F as Q,ab as Y}from"./vendor-DfCbaU-T.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const G={class:"d-flex align-center justify-space-between mb-2"},H={class:"d-flex gap-3 justify-end"},J={class:"font-weight-medium"},W={class:"text-caption text-medium-emphasis"},X={class:"text-caption text-medium-emphasis"},Z={class:"text-right"},ee={key:0},te={class:"text-sm text-medium-emphasis"},be=P({__name:"index",setup(le){z();const{user:E}=D(),y=n(!1),V=n(!1),g=n(null),d=n(""),h=n([]),C=n([]),c=n({current_page:1,last_page:1,per_page:20,total:0}),u=n({role:null,search:""}),K=async()=>{V.value=!0;try{const o=await x("/users/meta");C.value=o.data.roles}catch(o){d.value=b(o,"Filtre verileri alinamadi.")}finally{V.value=!1}},p=async(o=1)=>{y.value=!0,d.value="";try{const l=await x("/users",{query:{page:o,role:u.value.role||void 0,search:u.value.search||void 0}});h.value=l.data,c.value=l.meta}catch(l){d.value=b(l,"Kullanici listesi alinamadi.")}finally{y.value=!1}},M=async()=>{await p(1)},$=async()=>{u.value={role:null,search:""},await p(1)},j=async o=>{g.value=o.id,d.value="";try{await x(`/users/${o.id}`,{method:"DELETE"}),await p(c.value.current_page)}catch(l){d.value=b(l,"Kullanici silinemedi.")}finally{g.value=null}};return w(async()=>{await Promise.allSettled([K(),p(1)])}),(o,l)=>(v(),U(A,null,{default:a(()=>[e(m,{cols:"12"},{default:a(()=>[t("div",G,[l[3]||(l[3]=t("div",null,[t("h4",{class:"text-h4 mb-1"}," Kullanicilar "),t("p",{class:"text-medium-emphasis mb-0"}," Site kullanicilarini yonetin ")],-1)),e(f,{color:"primary","prepend-icon":"ri-user-add-line",to:"/management/users/create"},{default:a(()=>[...l[2]||(l[2]=[_(" Yeni Kullanici ",-1)])]),_:1})])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(F,{loading:s(V)},{default:a(()=>[e(S,null,{default:a(()=>[e(A,null,{default:a(()=>[e(m,{cols:"12",md:"3"},{default:a(()=>[e(I,{modelValue:s(u).role,"onUpdate:modelValue":l[0]||(l[0]=i=>s(u).role=i),items:s(C),"item-title":"label","item-value":"value",label:"Rol",clearable:""},null,8,["modelValue","items"])]),_:1}),e(m,{cols:"12",md:"9"},{default:a(()=>[e(N,{modelValue:s(u).search,"onUpdate:modelValue":l[1]||(l[1]=i=>s(u).search=i),label:"Arama",placeholder:"Ad, e-posta, telefon, TC"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[t("div",H,[e(f,{variant:"outlined",onClick:$},{default:a(()=>[...l[4]||(l[4]=[_(" Temizle ",-1)])]),_:1}),e(f,{color:"primary",onClick:M},{default:a(()=>[...l[5]||(l[5]=[_(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),s(d)?(v(),U(m,{key:0,cols:"12"},{default:a(()=>[e(R,{type:"error",variant:"tonal"},{default:a(()=>[_(r(s(d)),1)]),_:1})]),_:1})):B("",!0),e(m,{cols:"12"},{default:a(()=>[e(F,{loading:s(y)},{default:a(()=>[e(O,{density:"comfortable"},{default:a(()=>[l[7]||(l[7]=t("thead",null,[t("tr",null,[t("th",null,"Ad Soyad"),t("th",null,"Iletisim"),t("th",null,"Rol"),t("th",null,"Daire"),t("th",{class:"text-right"}," Islemler ")])],-1)),t("tbody",null,[(v(!0),k(Q,null,Y(s(h),i=>(v(),k("tr",{key:i.id},[t("td",null,[t("div",J,r(i.name),1),t("div",W,r(i.email||"-"),1)]),t("td",null,[t("div",null,r(i.phone||"-"),1),t("div",X,r(i.tc_kimlik||"-"),1)]),t("td",null,[e(q,{size:"small",color:"primary",variant:"tonal"},{default:a(()=>[_(r(i.role_label),1)]),_:2},1024)]),t("td",null,r(i.apartment_count),1),t("td",Z,[e(f,{icon:"",size:"small",variant:"text",to:`/management/users/${i.id}/edit`},{default:a(()=>[e(T,{icon:"ri-edit-line"})]),_:1},8,["to"]),e(f,{icon:"",size:"small",variant:"text",color:"error",disabled:s(E)?.id===i.id||s(g)===i.id,loading:s(g)===i.id,onClick:ae=>j(i)},{default:a(()=>[e(T,{icon:"ri-delete-bin-line"})]),_:1},8,["disabled","loading","onClick"])])]))),128)),s(h).length===0?(v(),k("tr",ee,[...l[6]||(l[6]=[t("td",{colspan:"5",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):B("",!0)])]),_:1}),e(S,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:a(()=>[t("span",te,"Toplam "+r(s(c).total)+" kayit",1),e(L,{"model-value":s(c).current_page,length:s(c).last_page,"total-visible":7,"onUpdate:modelValue":p},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{be as default};
