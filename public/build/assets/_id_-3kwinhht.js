import{j as S,f as M,h as r,D as j,Q as D,R,S as a,Z as F,ac as I,q as t,y as i,a8 as f,u as l,ag as q,O as k,ad as z}from"./vendor-qaEqcc9M.js";import{u as L,i as g}from"./useAbortOnUnmount-B_TyPYrd.js";import{$ as _,T as w,x as v,U as O}from"./main-DUODoQpR.js";import{V as P,r as A}from"./VForm-AfrkaUJk.js";import{V as C,a as u}from"./VRow-dBMGxjTF.js";import{V as Q}from"./VCard-DEMyauu_.js";import{V as Y}from"./VCardText-lEnvPJxp.js";import{V as Z}from"./VAlert-DIbLZTVg.js";import{V as G}from"./VTextField-BgtisBQp.js";import{V as H}from"./VTextarea-BWwjO-LJ.js";import{V as J}from"./VSwitch-C2gHzlAV.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VSelectionControl-DtdcpgRj.js";const K={class:"d-flex align-center justify-space-between mb-2"},W={class:"d-flex gap-2"},X={class:"d-flex justify-end gap-3"},ve=S({__name:"[id]",setup(ee){const{withAbort:V}=L(),E=F(),x=I(),y=M(()=>Number(E.params.id)),b=r(!1),d=r(!1),c=r(!1),s=r(""),p=r({}),n=r({title:"",content:"",is_published:!1}),h=r(null),T=[A()],U=[A()],$=async()=>{b.value=!0,s.value="";try{const o=await V(e=>_(`/announcements/${y.value}`,{signal:e}));n.value={title:o.data.title,content:o.data.content,is_published:o.data.is_published}}catch(o){if(g(o))return;s.value=w(o,"Duyuru detayi alinamadi.")}finally{b.value=!1}},B=async()=>{if((await h.value?.validate())?.valid){d.value=!0,s.value="",p.value={};try{await V(e=>_(`/announcements/${y.value}`,{method:"PUT",body:n.value,signal:e})),await x.push("/announcements")}catch(e){if(g(e))return;s.value=w(e,"Duyuru guncellenemedi."),p.value=O(e)}finally{d.value=!1}}},N=async()=>{c.value=!0,s.value="";try{await V(o=>_(`/announcements/${y.value}`,{method:"DELETE",signal:o})),await x.push("/announcements")}catch(o){if(g(o))return;s.value=w(o,"Duyuru silinemedi.")}finally{c.value=!1}};return j($),(o,e)=>(D(),R(C,null,{default:a(()=>[t(u,{cols:"12"},{default:a(()=>[i("div",K,[e[5]||(e[5]=i("div",null,[i("h4",{class:"text-h4 mb-1"}," Duyuru Duzenle "),i("p",{class:"text-medium-emphasis mb-0"}," Duyuruyu duzenleyin ")],-1)),i("div",W,[t(v,{variant:"outlined",to:"/announcements"},{default:a(()=>[...e[3]||(e[3]=[f(" Listeye Don ",-1)])]),_:1}),t(v,{color:"error",variant:"outlined",loading:l(c),disabled:l(c),onClick:N},{default:a(()=>[...e[4]||(e[4]=[f(" Sil ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1}),t(u,{cols:"12"},{default:a(()=>[t(Q,{loading:l(b)||l(d)},{default:a(()=>[t(Y,null,{default:a(()=>[t(P,{ref_key:"formRef",ref:h,onSubmit:q(B,["prevent"])},{default:a(()=>[t(C,null,{default:a(()=>[l(s)?(D(),R(u,{key:0,cols:"12"},{default:a(()=>[t(Z,{type:"error",variant:"tonal"},{default:a(()=>[f(k(l(s)),1)]),_:1})]),_:1})):z("",!0),t(u,{cols:"12"},{default:a(()=>[t(G,{modelValue:l(n).title,"onUpdate:modelValue":e[0]||(e[0]=m=>l(n).title=m),label:"Baslik",rules:T,"error-messages":l(p).title??[]},null,8,["modelValue","error-messages"])]),_:1}),t(u,{cols:"12"},{default:a(()=>[t(H,{modelValue:l(n).content,"onUpdate:modelValue":e[1]||(e[1]=m=>l(n).content=m),label:"Icerik",rows:"6",rules:U,"error-messages":l(p).content??[]},null,8,["modelValue","error-messages"])]),_:1}),t(u,{cols:"12"},{default:a(()=>[t(J,{modelValue:l(n).is_published,"onUpdate:modelValue":e[2]||(e[2]=m=>l(n).is_published=m),label:"Yayinda",color:"success"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12"},{default:a(()=>[i("div",X,[t(v,{variant:"outlined",to:"/announcements"},{default:a(()=>[...e[6]||(e[6]=[f(" Iptal ",-1)])]),_:1}),t(v,{color:"primary",type:"submit",loading:l(d),disabled:l(d)},{default:a(()=>[f(k(o.$t("common.update")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ve as default};
