import{j as O,h as n,D as j,Q as k,R,S as o,ac as D,q as l,y as c,O as g,a8 as v,u as a,ag as F,ad as K}from"./vendor-DfCbaU-T.js";import{u as q,i as h}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as x,T,x as _,U as I}from"./main-Btr01hqQ.js";import{V as P,r as V,c as Q,e as z,a as G,m as H,b as J}from"./VForm-D0fBkA3g.js";import{V as U,a as m}from"./VRow-CRn_xzm0.js";import{V as W}from"./VCard-BmPLTxO3.js";import{V as X}from"./VCardText-H2SttjXr.js";import{V as Y}from"./VAlert-R8JWKysv.js";import{V as i}from"./VTextField-pVQuWnMO.js";import{V as Z}from"./VSelect-DhbvR9Z1.js";import"./vuetify-DGZOXKNZ.js";import"./VAvatar-96oJdN2D.js";import"./VList-BYpc2SqC.js";import"./VDivider-DEGojtwS.js";import"./VCheckboxBtn-DaQGgEjM.js";import"./VSelectionControl-ClrOpdq3.js";import"./VChip-DOrTqiUh.js";const ee={class:"d-flex align-center justify-space-between mb-2"},ae={class:"text-h4 mb-1"},le={class:"text-medium-emphasis mb-0"},se={class:"d-flex justify-end gap-3"},ke=O({__name:"create",setup(oe){const{withAbort:b}=q(),C=D(),w=n(!1),d=n(!1),p=n(""),u=n({}),f=n([]),s=n({name:"",email:"",phone:"",tc_kimlik:"",password:"",password_confirmation:"",role:"owner"}),y=n(null),A=[V(),Q(100)],S=[V(),z()],M=[r=>typeof r!="string"||r.length===0?!0:G(11)(r)],E=[V(),H(8)],$=[V(),J(()=>s.value.password,"Şifreler eşleşmiyor.")],B=[V()],L=async()=>{w.value=!0;try{const r=await b(e=>x("/users/meta",{signal:e}));f.value=r.data.roles,f.value.length>0&&!f.value.some(e=>e.value===s.value.role)&&(s.value.role=f.value[0].value)}catch(r){if(h(r))return;p.value=T(r,"Rol listesi alınamadı.")}finally{w.value=!1}},N=async()=>{if((await y.value?.validate())?.valid){d.value=!0,p.value="",u.value={};try{await b(e=>x("/users",{method:"POST",body:{name:s.value.name,email:s.value.email,phone:s.value.phone||null,tc_kimlik:s.value.tc_kimlik||null,password:s.value.password,password_confirmation:s.value.password_confirmation,role:s.value.role},signal:e})),await C.push("/management/users")}catch(e){if(h(e))return;p.value=T(e,"Kullanıcı oluşturulamadı."),u.value=I(e)}finally{d.value=!1}}};return j(L),(r,e)=>(k(),R(U,null,{default:o(()=>[l(m,{cols:"12"},{default:o(()=>[c("div",ee,[c("div",null,[c("h4",ae,g(r.$t("pages.users.newTitle")),1),c("p",le,g(r.$t("pages.users.createSubtitle")),1)]),l(_,{variant:"outlined",to:"/management/users"},{default:o(()=>[...e[7]||(e[7]=[v(" Listeye Don ",-1)])]),_:1})])]),_:1}),l(m,{cols:"12"},{default:o(()=>[l(W,{loading:a(d)||a(w)},{default:o(()=>[l(X,null,{default:o(()=>[l(P,{ref_key:"formRef",ref:y,onSubmit:F(N,["prevent"])},{default:o(()=>[l(U,null,{default:o(()=>[a(p)?(k(),R(m,{key:0,cols:"12"},{default:o(()=>[l(Y,{type:"error",variant:"tonal"},{default:o(()=>[v(g(a(p)),1)]),_:1})]),_:1})):K("",!0),l(m,{cols:"12",md:"6"},{default:o(()=>[l(i,{modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).name=t),label:"Ad Soyad",rules:A,"error-messages":a(u).name??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(i,{modelValue:a(s).email,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).email=t),type:"email",label:"E-posta",rules:S,"error-messages":a(u).email??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(i,{modelValue:a(s).phone,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).phone=t),label:"Telefon","error-messages":a(u).phone??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(i,{modelValue:a(s).tc_kimlik,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).tc_kimlik=t),label:"TC Kimlik",maxlength:"11",rules:M,"error-messages":a(u).tc_kimlik??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(i,{modelValue:a(s).password,"onUpdate:modelValue":e[4]||(e[4]=t=>a(s).password=t),type:"password",label:"Şifre",rules:E,"error-messages":a(u).password??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(i,{modelValue:a(s).password_confirmation,"onUpdate:modelValue":e[5]||(e[5]=t=>a(s).password_confirmation=t),type:"password",label:"Şifre Tekrar",rules:$,"error-messages":a(u).password_confirmation??[]},null,8,["modelValue","error-messages"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(Z,{modelValue:a(s).role,"onUpdate:modelValue":e[6]||(e[6]=t=>a(s).role=t),items:a(f),"item-title":"label","item-value":"value",label:"Rol",rules:B,"error-messages":a(u).role??[]},null,8,["modelValue","items","error-messages"])]),_:1}),l(m,{cols:"12"},{default:o(()=>[c("div",se,[l(_,{variant:"outlined",to:"/management/users"},{default:o(()=>[...e[8]||(e[8]=[v(" Iptal ",-1)])]),_:1}),l(_,{color:"primary",type:"submit",loading:a(d),disabled:a(d)},{default:o(()=>[v(g(r.$t("common.save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ke as default};
