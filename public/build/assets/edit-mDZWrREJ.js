import{j as O,f as H,h as u,D as Q,Q as D,R as E,S as s,Z,ac as J,q as t,y as m,a8 as f,u as a,ag as K,O as W,ad as X}from"./vendor-DfCbaU-T.js";import{$ as _,T as b,x as y,U as Y}from"./main-OjHNd2U9.js";import{V as h,r as c,p as ee}from"./VForm-CtC6ldpE.js";import{u as ae,i as g}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as G,a as i}from"./VRow-Ba58lXtG.js";import{V as le}from"./VCard-9RfFlHpT.js";import{V as te}from"./VCardText-YweTyZzP.js";import{V as oe}from"./VAlert-DafHPFjN.js";import{V as S}from"./VTextField-CMxHKe9w.js";import{V as U}from"./VSelect-CMe3Xagq.js";import{V as se}from"./VSwitch-XgqsY1US.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";import"./VChip-CnrRRXXG.js";const re={class:"d-flex align-center justify-space-between mb-2"},ue={class:"d-flex gap-2"},ie={class:"d-flex justify-end gap-3"},Ne=O({__name:"edit",setup(de){const M=Z(),T=J(),x=H(()=>Number(M.params.id)),{withAbort:v}=ae(),w=u(!1),R=u(!1),p=u(!1),V=u(!1),d=u(""),n=u({}),A=u([]),N=u([]),k=u([]),o=u({name:"",amount:null,due_day:15,period:"monthly",vendor_id:null,account_id:null,is_active:!0}),C=u(null),$=[c()],B=[c()],F=[c()],j=[c(),ee()],P=[c(),l=>{const e=Number(l);return!Number.isInteger(e)||e<1||e>28?"Vade gunu 1 ile 28 arasinda olmalidir.":!0}],q=async()=>{w.value=!0;try{const l=await v(e=>_("/templates/expense/meta",{signal:e}));A.value=l.data.accounts,N.value=l.data.vendors,k.value=l.data.periods}catch(l){if(g(l))return;d.value=b(l,"Form verileri alinamadi.")}finally{w.value=!1}},z=async()=>{R.value=!0,d.value="";try{const l=await v(e=>_(`/templates/expense/${x.value}`,{signal:e}));o.value={name:l.data.name,amount:l.data.amount,due_day:l.data.due_day,period:l.data.period,vendor_id:l.data.vendor?.id??null,account_id:l.data.account?.id??null,is_active:l.data.is_active}}catch(l){if(g(l))return;d.value=b(l,"Gider sablonu alinamadi.")}finally{R.value=!1}},I=async()=>{if((await C.value?.validate())?.valid){p.value=!0,d.value="",n.value={};try{await v(e=>_(`/templates/expense/${x.value}`,{method:"PUT",body:{name:o.value.name,amount:o.value.amount,due_day:o.value.due_day,period:o.value.period,vendor_id:o.value.vendor_id,account_id:o.value.account_id,is_active:o.value.is_active},signal:e})),await T.push("/templates/expense")}catch(e){if(g(e))return;d.value=b(e,"Gider sablonu guncellenemedi."),n.value=Y(e)}finally{p.value=!1}}},L=async()=>{V.value=!0,d.value="";try{await v(l=>_(`/templates/expense/${x.value}`,{method:"DELETE",signal:l})),await T.push("/templates/expense")}catch(l){if(g(l))return;d.value=b(l,"Gider sablonu silinemedi.")}finally{V.value=!1}};return Q(async()=>{await Promise.allSettled([q(),z()])}),(l,e)=>(D(),E(G,null,{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[m("div",re,[e[9]||(e[9]=m("div",null,[m("h4",{class:"text-h4 mb-1"}," Gider Sablonu Duzenle "),m("p",{class:"text-medium-emphasis mb-0"}," Sablon bilgilerini guncelleyin ")],-1)),m("div",ue,[t(y,{variant:"outlined",to:"/templates/expense"},{default:s(()=>[...e[7]||(e[7]=[f(" Listeye Don ",-1)])]),_:1}),t(y,{color:"error",variant:"outlined",loading:a(V),disabled:a(V),onClick:L},{default:s(()=>[...e[8]||(e[8]=[f(" Sil ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1}),t(i,{cols:"12"},{default:s(()=>[t(le,{loading:a(w)||a(R)||a(p)},{default:s(()=>[t(te,null,{default:s(()=>[t(h,{ref_key:"formRef",ref:C,onSubmit:K(I,["prevent"])},{default:s(()=>[t(G,null,{default:s(()=>[a(d)?(D(),E(i,{key:0,cols:"12"},{default:s(()=>[t(oe,{type:"error",variant:"tonal"},{default:s(()=>[f(W(a(d)),1)]),_:1})]),_:1})):X("",!0),t(i,{cols:"12",md:"6"},{default:s(()=>[t(S,{modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=r=>a(o).name=r),label:"Sablon Adi",rules:$,"error-messages":a(n).name??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:s(()=>[t(U,{modelValue:a(o).vendor_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a(o).vendor_id=r),items:a(N),"item-title":"label","item-value":"id",label:"Tedarikci",clearable:"","error-messages":a(n).vendor_id??[]},null,8,["modelValue","items","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(U,{modelValue:a(o).account_id,"onUpdate:modelValue":e[2]||(e[2]=r=>a(o).account_id=r),items:a(A),"item-title":"label","item-value":"id",label:"Hesap",rules:B,"error-messages":a(n).account_id??[]},null,8,["modelValue","items","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(U,{modelValue:a(o).period,"onUpdate:modelValue":e[3]||(e[3]=r=>a(o).period=r),items:a(k),"item-title":"label","item-value":"value",label:"Periyot",rules:F,"error-messages":a(n).period??[]},null,8,["modelValue","items","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(S,{modelValue:a(o).due_day,"onUpdate:modelValue":e[4]||(e[4]=r=>a(o).due_day=r),type:"number",min:"1",max:"28",label:"Vade Gunu",rules:P,"error-messages":a(n).due_day??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12"},{default:s(()=>[t(S,{modelValue:a(o).amount,"onUpdate:modelValue":e[5]||(e[5]=r=>a(o).amount=r),type:"number",min:"0.01",step:"0.01",label:"Tutar",rules:j,"error-messages":a(n).amount??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12"},{default:s(()=>[t(se,{modelValue:a(o).is_active,"onUpdate:modelValue":e[6]||(e[6]=r=>a(o).is_active=r),label:"Aktif",color:"primary"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:s(()=>[m("div",ie,[t(y,{variant:"outlined",to:"/templates/expense"},{default:s(()=>[...e[10]||(e[10]=[f(" Vazgec ",-1)])]),_:1}),t(y,{color:"primary",type:"submit",loading:a(p),disabled:a(p)},{default:s(()=>[...e[11]||(e[11]=[f(" Guncelle ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{Ne as default};
