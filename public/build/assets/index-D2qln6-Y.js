import{$ as h,T as k,x as f,p as T}from"./main-OjHNd2U9.js";import{f as $,a as j}from"./formatters-BEv4aA23.js";import{u as z,i as C}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as w,a as n}from"./VRow-Ba58lXtG.js";import{V as A}from"./VCard-9RfFlHpT.js";import{V as S}from"./VCardText-YweTyZzP.js";import{V as D}from"./VSelect-CMe3Xagq.js";import{V as G}from"./VTextField-CMxHKe9w.js";import{V as N}from"./VAlert-DafHPFjN.js";import{V as q}from"./VTable-ByowNMkP.js";import{V as I}from"./VChip-CnrRRXXG.js";import{V as M}from"./VPagination-Laqr3CkN.js";import{j as L,h as u,D as O,Q as v,R as E,S as i,q as t,y as l,a8 as _,u as o,O as r,ad as F,V as g,F as R,ab as Y}from"./vendor-DfCbaU-T.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const H={class:"d-flex align-center justify-space-between mb-2"},K={class:"d-flex gap-3 justify-end"},Q={class:"text-right"},J={class:"text-right"},W={key:0},X={class:"text-sm text-medium-emphasis"},ge=L({__name:"index",setup(Z){const{withAbort:x}=z(),V=u(!1),y=u(null),d=u(""),b=u([]),m=u({current_page:1,last_page:1,per_page:20,total:0}),s=u({period:null,is_active:null,search:""}),c=async(p=1)=>{V.value=!0,d.value="";try{const e=await x(a=>h("/templates/expense",{query:{page:p,period:s.value.period||void 0,is_active:s.value.is_active===null?void 0:s.value.is_active?1:0,search:s.value.search||void 0},signal:a}));b.value=e.data,m.value=e.meta}catch(e){if(C(e))return;d.value=k(e,"Gider sablonlari alinamadi.")}finally{V.value=!1}},U=async()=>{await c(1)},B=async()=>{s.value={period:null,is_active:null,search:""},await c(1)},P=async p=>{y.value=p.id,d.value="";try{await x(e=>h(`/templates/expense/${p.id}`,{method:"DELETE",signal:e})),await c(m.value.current_page)}catch(e){if(C(e))return;d.value=k(e,"Gider sablonu silinemedi.")}finally{y.value=null}};return O(()=>c(1)),(p,e)=>(v(),E(w,null,{default:i(()=>[t(n,{cols:"12"},{default:i(()=>[l("div",H,[e[4]||(e[4]=l("div",null,[l("h4",{class:"text-h4 mb-1"}," Gider Sablonlari "),l("p",{class:"text-medium-emphasis mb-0"}," Gider sablonlarini yonetin ")],-1)),t(f,{color:"primary","prepend-icon":"ri-add-line",to:"/templates/expense/create"},{default:i(()=>[...e[3]||(e[3]=[_(" Yeni Sablon ",-1)])]),_:1})])]),_:1}),t(n,{cols:"12"},{default:i(()=>[t(A,null,{default:i(()=>[t(S,null,{default:i(()=>[t(w,null,{default:i(()=>[t(n,{cols:"12",md:"3"},{default:i(()=>[t(D,{modelValue:o(s).period,"onUpdate:modelValue":e[0]||(e[0]=a=>o(s).period=a),items:[{title:"Aylik",value:"monthly"},{title:"3 Aylik",value:"quarterly"},{title:"Yillik",value:"yearly"}],label:"Periyot",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"3"},{default:i(()=>[t(D,{modelValue:o(s).is_active,"onUpdate:modelValue":e[1]||(e[1]=a=>o(s).is_active=a),items:[{title:"Aktif",value:!0},{title:"Pasif",value:!1}],label:"Durum",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"6"},{default:i(()=>[t(G,{modelValue:o(s).search,"onUpdate:modelValue":e[2]||(e[2]=a=>o(s).search=a),label:"Arama",placeholder:"Sablon adi"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12"},{default:i(()=>[l("div",K,[t(f,{variant:"outlined",onClick:B},{default:i(()=>[...e[5]||(e[5]=[_(" Temizle ",-1)])]),_:1}),t(f,{color:"primary",onClick:U},{default:i(()=>[...e[6]||(e[6]=[_(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(d)?(v(),E(n,{key:0,cols:"12"},{default:i(()=>[t(N,{type:"error",variant:"tonal"},{default:i(()=>[_(r(o(d)),1)]),_:1})]),_:1})):F("",!0),t(n,{cols:"12"},{default:i(()=>[t(A,{loading:o(V)},{default:i(()=>[t(q,{density:"comfortable"},{default:i(()=>[e[8]||(e[8]=l("thead",null,[l("tr",null,[l("th",null,"Sablon"),l("th",null,"Tedarikci"),l("th",null,"Hesap"),l("th",{class:"text-right"}," Tutar "),l("th",null,"Vade"),l("th",null,"Periyot"),l("th",null,"Durum"),l("th",null,"Son Uretim"),l("th",{class:"text-right"}," Islemler ")])],-1)),l("tbody",null,[(v(!0),g(R,null,Y(o(b),a=>(v(),g("tr",{key:a.id},[l("td",null,r(a.name),1),l("td",null,r(a.vendor?.label??"-"),1),l("td",null,r(a.account?.label??"-"),1),l("td",Q,r(o($)(a.amount)),1),l("td",null,r(a.due_day)+". gun",1),l("td",null,r(a.period_label),1),l("td",null,[t(I,{size:"small",color:a.is_active?"success":"secondary",variant:"tonal"},{default:i(()=>[_(r(a.is_active?"Aktif":"Pasif"),1)]),_:2},1032,["color"])]),l("td",null,r(o(j)(a.last_generated_at)),1),l("td",J,[t(f,{icon:"",size:"small",variant:"text",to:`/templates/expense/${a.id}/edit`},{default:i(()=>[t(T,{icon:"ri-edit-line"})]),_:1},8,["to"]),t(f,{icon:"",size:"small",variant:"text",color:"error",loading:o(y)===a.id,disabled:o(y)===a.id,onClick:ee=>P(a)},{default:i(()=>[t(T,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),o(b).length===0?(v(),g("tr",W,[...e[7]||(e[7]=[l("td",{colspan:"9",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):F("",!0)])]),_:1}),t(S,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:i(()=>[l("span",X,"Toplam "+r(o(m).total)+" kayit",1),t(M,{"model-value":o(m).current_page,length:o(m).last_page,"total-visible":7,"onUpdate:modelValue":c},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ge as default};
