import{j as M,f as j,h as m,D as z,Q as w,R as x,S as r,Z as P,ac as q,q as t,y as f,u as a,a8 as b,ag as I,O as K,ad as O}from"./vendor-DfCbaU-T.js";import{$ as V,T as _,x as y,U as G}from"./main-OjHNd2U9.js";import{V as L,r as R,p as Q}from"./VForm-CtC6ldpE.js";import{u as Z}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as N,a as i}from"./VRow-Ba58lXtG.js";import{V as H}from"./VCard-9RfFlHpT.js";import{V as J}from"./VCardText-YweTyZzP.js";import{V as W}from"./VAlert-DafHPFjN.js";import{V as c}from"./VTextField-CMxHKe9w.js";import{V as X}from"./VSwitch-XgqsY1US.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VSelectionControl-Ck2LTPqY.js";const Y={class:"d-flex align-center justify-space-between mb-2"},h={class:"d-flex gap-2"},ee={class:"d-flex justify-end gap-3"},ce=M({__name:"edit",setup(ae){const U=P(),k=q(),{withAbort:A}=Z(),d=j(()=>Number(U.params.id)),g=m(!1),p=m(!1),v=m(!1),u=m(""),n=m({}),o=m({block:"",floor:null,number:"",m2:null,arsa_payi:null,is_active:!0}),D=m(null),$=[R(),l=>Number.isInteger(Number(l))?!0:"Kat bilgisi tam sayi olmalidir."],C=[R()],E=[l=>l==null||l===""?!0:Q()(l)],S=[l=>{if(l==null||l==="")return!0;const e=Number(l);return Number.isFinite(e)&&e>=0?!0:"Sifir veya daha buyuk bir deger giriniz."}],T=async()=>{g.value=!0,u.value="";try{const l=await A(e=>V(`/apartments/${d.value}`,{signal:e}));o.value={block:l.data.block??"",floor:l.data.floor,number:l.data.number,m2:l.data.m2,arsa_payi:l.data.arsa_payi,is_active:l.data.is_active}}catch(l){u.value=_(l,"Daire detayi alinamadi.")}finally{g.value=!1}},B=async()=>{if((await D.value?.validate())?.valid){p.value=!0,u.value="",n.value={};try{await V(`/apartments/${d.value}`,{method:"PUT",body:{block:o.value.block||null,floor:o.value.floor,number:o.value.number,m2:o.value.m2,arsa_payi:o.value.arsa_payi,is_active:o.value.is_active}}),await k.push(`/management/apartments/${d.value}`)}catch(e){u.value=_(e,"Daire guncellenemedi."),n.value=G(e)}finally{p.value=!1}}},F=async()=>{v.value=!0,u.value="";try{await V(`/apartments/${d.value}`,{method:"DELETE"}),await k.push("/management/apartments")}catch(l){u.value=_(l,"Daire silinemedi.")}finally{v.value=!1}};return z(T),(l,e)=>(w(),x(N,null,{default:r(()=>[t(i,{cols:"12"},{default:r(()=>[f("div",Y,[e[8]||(e[8]=f("div",null,[f("h4",{class:"text-h4 mb-1"}," Daire Duzenle "),f("p",{class:"text-medium-emphasis mb-0"}," Daire kaydini guncelleyin ")],-1)),f("div",h,[t(y,{variant:"outlined",to:`/management/apartments/${a(d)}`},{default:r(()=>[...e[6]||(e[6]=[b(" Detaya Don ",-1)])]),_:1},8,["to"]),t(y,{color:"error",variant:"outlined",loading:a(v),disabled:a(v),onClick:F},{default:r(()=>[...e[7]||(e[7]=[b(" Sil ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1}),t(i,{cols:"12"},{default:r(()=>[t(H,{loading:a(g)||a(p)},{default:r(()=>[t(J,null,{default:r(()=>[t(L,{ref_key:"formRef",ref:D,onSubmit:I(B,["prevent"])},{default:r(()=>[t(N,null,{default:r(()=>[a(u)?(w(),x(i,{key:0,cols:"12"},{default:r(()=>[t(W,{type:"error",variant:"tonal"},{default:r(()=>[b(K(a(u)),1)]),_:1})]),_:1})):O("",!0),t(i,{cols:"12",md:"4"},{default:r(()=>[t(c,{modelValue:a(o).block,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).block=s),label:"Blok","error-messages":a(n).block??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:r(()=>[t(c,{modelValue:a(o).floor,"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).floor=s),type:"number",label:"Kat",rules:$,"error-messages":a(n).floor??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12",md:"4"},{default:r(()=>[t(c,{modelValue:a(o).number,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).number=s),label:"Daire No",rules:C,"error-messages":a(n).number??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:r(()=>[t(c,{modelValue:a(o).m2,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).m2=s),type:"number",min:"1",step:"0.01",label:"m2",rules:E,"error-messages":a(n).m2??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12",md:"6"},{default:r(()=>[t(c,{modelValue:a(o).arsa_payi,"onUpdate:modelValue":e[4]||(e[4]=s=>a(o).arsa_payi=s),type:"number",min:"0",step:"0.000001",label:"Arsa Payi",rules:S,"error-messages":a(n).arsa_payi??[]},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"12"},{default:r(()=>[t(X,{modelValue:a(o).is_active,"onUpdate:modelValue":e[5]||(e[5]=s=>a(o).is_active=s),label:"Aktif",color:"primary"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:r(()=>[f("div",ee,[t(y,{variant:"outlined",to:`/management/apartments/${a(d)}`},{default:r(()=>[...e[9]||(e[9]=[b(" Vazgec ",-1)])]),_:1},8,["to"]),t(y,{color:"primary",type:"submit",loading:a(p),disabled:a(p)},{default:r(()=>[...e[10]||(e[10]=[b(" Guncelle ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ce as default};
