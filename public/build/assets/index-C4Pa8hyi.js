import{e as z,$ as S,T as w,x as f,p as k}from"./main-OjHNd2U9.js";import{a as M}from"./formatters-BEv4aA23.js";import{j as N,h as d,f as I,D as P,Q as v,R as C,S as l,ac as R,q as t,y as e,a8 as _,u as i,O as o,ad as T,V as y,F as U,ab as q}from"./vendor-DfCbaU-T.js";import{V as A,a as r}from"./VRow-Ba58lXtG.js";import{V as D}from"./VCard-9RfFlHpT.js";import{V as F}from"./VCardText-YweTyZzP.js";import{V as L}from"./VSelect-CMe3Xagq.js";import{V as O}from"./VTextField-CMxHKe9w.js";import{V as Y}from"./VAlert-DafHPFjN.js";import{V as K}from"./VTable-ByowNMkP.js";import{V as Q}from"./VChip-CnrRRXXG.js";import{V as G}from"./VPagination-Laqr3CkN.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const H={class:"d-flex align-center justify-space-between mb-2"},J={class:"d-flex gap-3 justify-end"},W={class:"font-weight-medium"},X={class:"text-caption text-medium-emphasis"},Z={class:"text-caption text-medium-emphasis"},ee={class:"text-right"},te={key:0},ae={class:"text-sm text-medium-emphasis"},Se=N({__name:"index",setup(le){const B=R(),x=z(),g=d(!1),V=d(null),u=d(""),h=d([]),m=d({current_page:1,last_page:1,per_page:15,total:0}),n=d({is_active:null,search:""}),b=I(()=>x.can("sites.manage")),c=async(p=1)=>{if(b.value){g.value=!0,u.value="";try{const a=await S("/super/sites",{query:{page:p,is_active:n.value.is_active===null?void 0:n.value.is_active?1:0,search:n.value.search||void 0}});h.value=a.data,m.value=a.meta}catch(a){u.value=w(a,"Site listesi alinamadi.")}finally{g.value=!1}}},E=async()=>{await c(1)},$=async()=>{n.value={is_active:null,search:""},await c(1)},j=async p=>{V.value=p.id,u.value="";try{await S(`/super/sites/${p.id}`,{method:"DELETE"}),await c(m.value.current_page)}catch(a){u.value=w(a,"Site silinemedi.")}finally{V.value=null}};return P(async()=>{if(await x.ensureSession(),!b.value){await B.replace("/");return}await c(1)}),(p,a)=>(v(),C(A,null,{default:l(()=>[t(r,{cols:"12"},{default:l(()=>[e("div",H,[a[3]||(a[3]=e("div",null,[e("h4",{class:"text-h4 mb-1"}," Siteler "),e("p",{class:"text-medium-emphasis mb-0"}," Super admin site yonetimi ")],-1)),t(f,{color:"primary","prepend-icon":"ri-add-line",to:"/super/sites/create"},{default:l(()=>[...a[2]||(a[2]=[_(" Yeni Site ",-1)])]),_:1})])]),_:1}),t(r,{cols:"12"},{default:l(()=>[t(D,null,{default:l(()=>[t(F,null,{default:l(()=>[t(A,null,{default:l(()=>[t(r,{cols:"12",md:"3"},{default:l(()=>[t(L,{modelValue:i(n).is_active,"onUpdate:modelValue":a[0]||(a[0]=s=>i(n).is_active=s),items:[{title:"Aktif",value:!0},{title:"Pasif",value:!1}],label:"Durum",clearable:""},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"9"},{default:l(()=>[t(O,{modelValue:i(n).search,"onUpdate:modelValue":a[1]||(a[1]=s=>i(n).search=s),label:"Arama",placeholder:"Site adi, telefon, vergi no"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12"},{default:l(()=>[e("div",J,[t(f,{variant:"outlined",onClick:$},{default:l(()=>[...a[4]||(a[4]=[_(" Temizle ",-1)])]),_:1}),t(f,{color:"primary",onClick:E},{default:l(()=>[...a[5]||(a[5]=[_(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(u)?(v(),C(r,{key:0,cols:"12"},{default:l(()=>[t(Y,{type:"error",variant:"tonal"},{default:l(()=>[_(o(i(u)),1)]),_:1})]),_:1})):T("",!0),t(r,{cols:"12"},{default:l(()=>[t(D,{loading:i(g)},{default:l(()=>[t(K,{density:"comfortable"},{default:l(()=>[a[7]||(a[7]=e("thead",null,[e("tr",null,[e("th",null,"Site"),e("th",null,"Yonetici"),e("th",null,"Telefon"),e("th",null,"Durum"),e("th",null,"Olusturma"),e("th",{class:"text-right"}," Islemler ")])],-1)),e("tbody",null,[(v(!0),y(U,null,q(i(h),s=>(v(),y("tr",{key:s.id},[e("td",null,[e("div",W,o(s.name),1),e("div",X,o(s.address||"-"),1)]),e("td",null,[e("div",null,o(s.admin?.name||"-"),1),e("div",Z,o(s.admin?.email||"-"),1)]),e("td",null,o(s.phone||"-"),1),e("td",null,[t(Q,{size:"small",color:s.is_active?"success":"secondary",variant:"tonal"},{default:l(()=>[_(o(s.is_active?"Aktif":"Pasif"),1)]),_:2},1032,["color"])]),e("td",null,o(i(M)(s.created_at)),1),e("td",ee,[t(f,{icon:"",size:"small",variant:"text",to:`/super/sites/${s.id}/edit`},{default:l(()=>[t(k,{icon:"ri-edit-line"})]),_:1},8,["to"]),t(f,{icon:"",size:"small",variant:"text",color:"error",loading:i(V)===s.id,disabled:i(V)===s.id,onClick:se=>j(s)},{default:l(()=>[t(k,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),i(h).length===0?(v(),y("tr",te,[...a[6]||(a[6]=[e("td",{colspan:"6",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):T("",!0)])]),_:1}),t(F,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[e("span",ae,"Toplam "+o(i(m).total)+" kayit",1),t(G,{"model-value":i(m).current_page,length:i(m).last_page,"total-visible":7,"onUpdate:modelValue":c},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{Se as default};
