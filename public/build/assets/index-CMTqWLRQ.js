import{j as le,h as n,D as te,Q as _,R as D,S as l,q as a,y as i,a8 as m,u as t,O as y,ad as M,V as F,F as se,ab as ie,H as oe,ag as ne}from"./vendor-DfCbaU-T.js";import{u as re}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as b,T as w,x as p,p as H,V as ue,U as de}from"./main-OjHNd2U9.js";import{f as K}from"./formatters-BEv4aA23.js";import{V as me,r as O}from"./VForm-CtC6ldpE.js";import{V as z,a as u}from"./VRow-Ba58lXtG.js";import{V as E,d as pe}from"./VCard-9RfFlHpT.js";import{V as R}from"./VCardText-YweTyZzP.js";import{V as P}from"./VSelect-CMe3Xagq.js";import{V as S}from"./VTextField-CMxHKe9w.js";import{V as ce}from"./VAlert-DafHPFjN.js";import{V as fe}from"./VTable-ByowNMkP.js";import{V as j}from"./VChip-CnrRRXXG.js";import{V as ve}from"./VPagination-Laqr3CkN.js";import{V as ye}from"./VDialog-BQJ2uzM5.js";import{V as ge}from"./VSwitch-XgqsY1US.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const Ve={class:"d-flex align-center justify-space-between mb-2"},_e={class:"d-flex gap-3 justify-end"},be={class:"font-weight-medium"},he={class:"text-right"},xe={class:"text-right font-weight-medium"},ke={class:"text-right"},Ce={key:0},we={class:"text-sm text-medium-emphasis"},Qe=le({__name:"index",setup(Ae){re();const A=n(!1),T=n(!1),h=n(!1),x=n(null),d=n(""),c=n({}),U=n([]),B=n([]),g=n({current_page:1,last_page:1,per_page:20,total:0}),f=n({type:null,search:""}),v=n(!1),k=n(!1),C=n(null),r=n({name:"",type:"cash",opening_balance:0,is_active:!0}),$=n(null),I=[O()],q=[O()],L=[o=>{const e=Number(o);return Number.isFinite(e)&&e>=0?!0:"Sifir veya daha buyuk bir deger giriniz."}],Y=o=>o==="cash"?"success":"primary",G=async()=>{T.value=!0;try{const o=await b("/cash-accounts/meta");B.value=o.data.types}catch(o){d.value=w(o,"Hesap turleri alinamadi.")}finally{T.value=!1}},V=async(o=1)=>{A.value=!0,d.value="";try{const e=await b("/cash-accounts",{query:{page:o,type:f.value.type||void 0,search:f.value.search||void 0}});U.value=e.data,g.value=e.meta}catch(e){d.value=w(e,"Kasa/Banka hesaplari alinamadi.")}finally{A.value=!1}},Q=()=>{k.value=!1,C.value=null,r.value={name:"",type:"cash",opening_balance:0,is_active:!0},c.value={}},J=()=>{Q(),v.value=!0},W=o=>{k.value=!0,C.value=o.id,r.value={name:o.name,type:o.type,opening_balance:Number(o.opening_balance),is_active:o.is_active},c.value={},v.value=!0},N=async()=>{if((await $.value?.validate())?.valid){h.value=!0,d.value="",c.value={};try{k.value&&C.value?await b(`/cash-accounts/${C.value}`,{method:"PUT",body:r.value}):await b("/cash-accounts",{method:"POST",body:r.value}),v.value=!1,await V(g.value.current_page)}catch(e){d.value=w(e,"Hesap kaydedilemedi."),c.value=de(e)}finally{h.value=!1}}},X=async o=>{x.value=o.id,d.value="";try{await b(`/cash-accounts/${o.id}`,{method:"DELETE"}),await V(g.value.current_page)}catch(e){d.value=w(e,"Hesap silinemedi.")}finally{x.value=null}},Z=async()=>{await V(1)},ee=async()=>{f.value={type:null,search:""},await V(1)};return te(async()=>{await Promise.allSettled([G(),V(1)])}),(o,e)=>(_(),D(z,null,{default:l(()=>[a(u,{cols:"12"},{default:l(()=>[i("div",Ve,[e[9]||(e[9]=i("div",null,[i("h4",{class:"text-h4 mb-1"}," Kasa/Banka "),i("p",{class:"text-medium-emphasis mb-0"}," Kasa ve banka hesaplarini yonetin ")],-1)),a(p,{color:"primary","prepend-icon":"ri-add-line",onClick:J},{default:l(()=>[...e[8]||(e[8]=[m(" Yeni Hesap ",-1)])]),_:1})])]),_:1}),a(u,{cols:"12"},{default:l(()=>[a(E,{loading:t(T)},{default:l(()=>[a(R,null,{default:l(()=>[a(z,null,{default:l(()=>[a(u,{cols:"12",md:"4"},{default:l(()=>[a(P,{modelValue:t(f).type,"onUpdate:modelValue":e[0]||(e[0]=s=>t(f).type=s),items:t(B),"item-title":"label","item-value":"value",label:"Tur",clearable:""},null,8,["modelValue","items"])]),_:1}),a(u,{cols:"12",md:"8"},{default:l(()=>[a(S,{modelValue:t(f).search,"onUpdate:modelValue":e[1]||(e[1]=s=>t(f).search=s),label:"Arama",placeholder:"Hesap adi"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12"},{default:l(()=>[i("div",_e,[a(p,{variant:"outlined",onClick:ee},{default:l(()=>[...e[10]||(e[10]=[m(" Temizle ",-1)])]),_:1}),a(p,{color:"primary",onClick:Z},{default:l(()=>[...e[11]||(e[11]=[m(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),t(d)?(_(),D(u,{key:0,cols:"12"},{default:l(()=>[a(ce,{type:"error",variant:"tonal"},{default:l(()=>[m(y(t(d)),1)]),_:1})]),_:1})):M("",!0),a(u,{cols:"12"},{default:l(()=>[a(E,{loading:t(A)},{default:l(()=>[a(fe,{density:"comfortable"},{default:l(()=>[e[13]||(e[13]=i("thead",null,[i("tr",null,[i("th",null,"Hesap"),i("th",null,"Tur"),i("th",{class:"text-right"}," Acilis "),i("th",{class:"text-right"}," Guncel Bakiye "),i("th",null,"Durum"),i("th",{class:"text-right"}," Islemler ")])],-1)),i("tbody",null,[(_(!0),F(se,null,ie(t(U),s=>(_(),F("tr",{key:s.id},[i("td",null,[i("div",be,y(s.name),1)]),i("td",null,[a(j,{size:"small",color:Y(s.type),variant:"tonal"},{default:l(()=>[m(y(s.type_label),1)]),_:2},1032,["color"])]),i("td",he,y(t(K)(s.opening_balance)),1),i("td",xe,y(t(K)(s.balance)),1),i("td",null,[a(j,{size:"small",color:s.is_active?"success":"secondary",variant:"tonal"},{default:l(()=>[m(y(s.is_active?"Aktif":"Pasif"),1)]),_:2},1032,["color"])]),i("td",ke,[a(p,{icon:"",size:"small",variant:"text",to:`/cash-accounts/${s.id}/statement`},{default:l(()=>[a(H,{icon:"ri-file-chart-line"})]),_:1},8,["to"]),a(p,{icon:"",size:"small",variant:"text",onClick:ae=>W(s)},{default:l(()=>[a(H,{icon:"ri-edit-line"})]),_:1},8,["onClick"]),a(p,{icon:"",size:"small",variant:"text",color:"error",loading:t(x)===s.id,disabled:t(x)===s.id,onClick:ae=>X(s)},{default:l(()=>[a(H,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),t(U).length===0?(_(),F("tr",Ce,[...e[12]||(e[12]=[i("td",{colspan:"6",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):M("",!0)])]),_:1}),a(R,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[i("span",we,"Toplam "+y(t(g).total)+" kayit",1),a(ve,{"model-value":t(g).current_page,length:t(g).last_page,"total-visible":7,"onUpdate:modelValue":V},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1}),a(ye,{modelValue:t(v),"onUpdate:modelValue":e[7]||(e[7]=s=>oe(v)?v.value=s:null),"max-width":"560"},{default:l(()=>[a(E,{title:t(k)?"Hesap Duzenle":"Yeni Hesap"},{default:l(()=>[a(R,null,{default:l(()=>[a(me,{ref_key:"formRef",ref:$,onSubmit:ne(N,["prevent"])},{default:l(()=>[a(z,null,{default:l(()=>[a(u,{cols:"12"},{default:l(()=>[a(S,{modelValue:t(r).name,"onUpdate:modelValue":e[2]||(e[2]=s=>t(r).name=s),label:"Hesap Adi",rules:I,"error-messages":t(c).name??[]},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",md:"6"},{default:l(()=>[a(P,{modelValue:t(r).type,"onUpdate:modelValue":e[3]||(e[3]=s=>t(r).type=s),items:t(B),"item-title":"label","item-value":"value",label:"Tur",rules:q,"error-messages":t(c).type??[]},null,8,["modelValue","items","error-messages"])]),_:1}),a(u,{cols:"12",md:"6"},{default:l(()=>[a(S,{modelValue:t(r).opening_balance,"onUpdate:modelValue":e[4]||(e[4]=s=>t(r).opening_balance=s),type:"number",min:"0",step:"0.01",label:"Acilis Bakiyesi",rules:L,"error-messages":t(c).opening_balance??[]},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12"},{default:l(()=>[a(ge,{modelValue:t(r).is_active,"onUpdate:modelValue":e[5]||(e[5]=s=>t(r).is_active=s),label:"Aktif",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(pe,{class:"px-6 pb-4"},{default:l(()=>[a(ue),a(p,{variant:"outlined",onClick:e[6]||(e[6]=s=>v.value=!1)},{default:l(()=>[...e[14]||(e[14]=[m(" Vazgec ",-1)])]),_:1}),a(p,{color:"primary",loading:t(h),disabled:t(h),onClick:N},{default:l(()=>[...e[15]||(e[15]=[m(" Kaydet ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}))}});export{Qe as default};
