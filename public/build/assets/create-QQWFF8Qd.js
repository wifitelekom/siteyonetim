import{j as h,h as m,D as L,Q as b,R as y,S as s,ac as P,q as l,y as p,O as g,a8 as f,u as a,ag as Q,ad as C}from"./vendor-qaEqcc9M.js";import{$ as M,T,x as _,U as Y}from"./main-DUODoQpR.js";import{V as G,r as c,p as H}from"./VForm-AfrkaUJk.js";import{u as J,i as k}from"./useAbortOnUnmount-B_TyPYrd.js";import{V as D,a as u}from"./VRow-dBMGxjTF.js";import{V as K}from"./VCard-DEMyauu_.js";import{V as W}from"./VCardText-lEnvPJxp.js";import{V as X}from"./VAlert-DIbLZTVg.js";import{V as R}from"./VTextField-BgtisBQp.js";import{V as $}from"./VSelect-BpDYXa0x.js";import{V as Z}from"./VSwitch-C2gHzlAV.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";import"./VChip-CzUAJTHl.js";const ee={class:"d-flex align-center justify-space-between mb-2"},ae={class:"text-medium-emphasis mb-0"},te={class:"d-flex justify-end gap-3"},$e=h({__name:"create",setup(le){const E=P(),{withAbort:w}=J(),v={path:"/templates/aidat"},V=m(!1),i=m(!1),d=m(""),n=m({}),A=m([]),U=m([]),N=m([]),t=m({name:"",amount:null,due_day:15,account_id:null,scope:"all",apartment_ids:[],is_active:!0}),S=m(null),B=[c()],F=[c()],O=[c(),H()],j=[c(),o=>{const e=Number(o);return!Number.isInteger(e)||e<1||e>28?"Vade gunu 1 ile 28 arasinda olmalidir.":!0}],x=[c()],q=[o=>t.value.scope!=="selected"||Array.isArray(o)&&o.length>0?!0:"En az bir daire seçiniz."],z=async()=>{V.value=!0;try{const o=await w(e=>M("/templates/aidat/meta",{signal:e}));A.value=o.data.accounts,U.value=o.data.apartments,N.value=o.data.scopes}catch(o){if(k(o))return;d.value=T(o,"Form verileri alınamadı.")}finally{V.value=!1}},I=async()=>{if((await S.value?.validate())?.valid){i.value=!0,d.value="",n.value={};try{await w(e=>M("/templates/aidat",{method:"POST",body:{name:t.value.name,amount:t.value.amount,due_day:t.value.due_day,account_id:t.value.account_id,scope:t.value.scope,apartment_ids:t.value.scope==="selected"?t.value.apartment_ids:[],is_active:t.value.is_active},signal:e})),await E.push(v)}catch(e){if(k(e))return;d.value=T(e,"Aidat şablonu oluşturulamadı."),n.value=Y(e)}finally{i.value=!1}}};return L(z),(o,e)=>(b(),y(D,null,{default:s(()=>[l(u,{cols:"12"},{default:s(()=>[p("div",ee,[p("div",null,[e[7]||(e[7]=p("h4",{class:"text-h4 mb-1"}," Yeni Aidat Şablonu ",-1)),p("p",ae,g(o.$t("pages.aidatTemplates.createSubtitle")),1)]),l(_,{variant:"outlined",to:v},{default:s(()=>[...e[8]||(e[8]=[f(" Listeye Don ",-1)])]),_:1})])]),_:1}),l(u,{cols:"12"},{default:s(()=>[l(K,{loading:a(i)||a(V)},{default:s(()=>[l(W,null,{default:s(()=>[l(G,{ref_key:"formRef",ref:S,onSubmit:Q(I,["prevent"])},{default:s(()=>[l(D,null,{default:s(()=>[a(d)?(b(),y(u,{key:0,cols:"12"},{default:s(()=>[l(X,{type:"error",variant:"tonal"},{default:s(()=>[f(g(a(d)),1)]),_:1})]),_:1})):C("",!0),l(u,{cols:"12",md:"6"},{default:s(()=>[l(R,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=r=>a(t).name=r),label:o.$t("common.templateName"),rules:B,"error-messages":a(n).name??[]},null,8,["modelValue","label","error-messages"])]),_:1}),l(u,{cols:"12",md:"6"},{default:s(()=>[l($,{modelValue:a(t).account_id,"onUpdate:modelValue":e[1]||(e[1]=r=>a(t).account_id=r),items:a(A),"item-title":"label","item-value":"id",label:o.$t("common.account"),rules:F,"error-messages":a(n).account_id??[]},null,8,["modelValue","items","label","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l(R,{modelValue:a(t).amount,"onUpdate:modelValue":e[2]||(e[2]=r=>a(t).amount=r),type:"number",min:"0.01",step:"0.01",label:o.$t("common.amount"),rules:O,"error-messages":a(n).amount??[]},null,8,["modelValue","label","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l(R,{modelValue:a(t).due_day,"onUpdate:modelValue":e[3]||(e[3]=r=>a(t).due_day=r),type:"number",min:"1",max:"28",label:o.$t("common.dueDay"),rules:j,"error-messages":a(n).due_day??[]},null,8,["modelValue","label","error-messages"])]),_:1}),l(u,{cols:"12",md:"4"},{default:s(()=>[l($,{modelValue:a(t).scope,"onUpdate:modelValue":e[4]||(e[4]=r=>a(t).scope=r),items:a(N),"item-title":"label","item-value":"value",label:o.$t("common.scope"),rules:x,"error-messages":a(n).scope??[]},null,8,["modelValue","items","label","error-messages"])]),_:1}),a(t).scope==="selected"?(b(),y(u,{key:1,cols:"12"},{default:s(()=>[l($,{modelValue:a(t).apartment_ids,"onUpdate:modelValue":e[5]||(e[5]=r=>a(t).apartment_ids=r),items:a(U),"item-title":"label","item-value":"id",label:o.$t("common.apartments"),multiple:"",chips:"","closable-chips":"",rules:q,"error-messages":a(n).apartment_ids??[]},null,8,["modelValue","items","label","error-messages"])]),_:1})):C("",!0),l(u,{cols:"12"},{default:s(()=>[l(Z,{modelValue:a(t).is_active,"onUpdate:modelValue":e[6]||(e[6]=r=>a(t).is_active=r),label:o.$t("common.active"),color:"primary"},null,8,["modelValue","label"])]),_:1}),l(u,{cols:"12"},{default:s(()=>[p("div",te,[l(_,{variant:"outlined",to:v},{default:s(()=>[...e[9]||(e[9]=[f(" Iptal ",-1)])]),_:1}),l(_,{color:"primary",type:"submit",loading:a(i),disabled:a(i)},{default:s(()=>[f(g(o.$t("common.save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{$e as default};
