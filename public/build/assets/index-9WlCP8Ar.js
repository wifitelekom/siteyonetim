import{$ as x,T as k,x as u,q as y}from"./main-Btr01hqQ.js";import{u as j,i as w}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as C,a as d}from"./VRow-CRn_xzm0.js";import{V as A}from"./VCard-BmPLTxO3.js";import{V as B}from"./VCardText-H2SttjXr.js";import{V as z}from"./VSelect-DhbvR9Z1.js";import{V as N}from"./VTextField-pVQuWnMO.js";import{V as R}from"./VAlert-R8JWKysv.js";import{V as U}from"./VTable-5XBH4x9y.js";import{V as q}from"./VChip-DOrTqiUh.js";import{V as M}from"./VPagination-9yrd3TeG.js";import{j as I,h as c,D as L,Q as v,R as D,S as s,q as e,y as t,O as i,a8 as _,u as n,ad as E,V as b,F as O,ab as K}from"./vendor-DfCbaU-T.js";import"./vuetify-DGZOXKNZ.js";import"./VAvatar-96oJdN2D.js";import"./VList-BYpc2SqC.js";import"./VDivider-DEGojtwS.js";import"./VCheckboxBtn-DaQGgEjM.js";import"./VSelectionControl-ClrOpdq3.js";const P={class:"d-flex align-center justify-space-between mb-2"},Q={class:"text-medium-emphasis mb-0"},Y={class:"d-flex gap-3 justify-end"},G={class:"text-right"},H={class:"font-weight-medium"},J={class:"text-caption text-medium-emphasis"},W={class:"text-caption text-medium-emphasis"},X={class:"text-right"},Z={class:"text-right"},ee={class:"text-right"},te={key:0},ae={colspan:"6",class:"text-center text-medium-emphasis py-6"},le={class:"text-sm text-medium-emphasis"},ke=I({__name:"index",setup(se){const{withAbort:$}=j(),g=c(!1),h=c(null),m=c(""),V=c([]),p=c({current_page:1,last_page:1,per_page:20,total:0}),r=c({is_active:null,search:""}),f=async(o=1)=>{g.value=!0,m.value="";try{const a=await $(l=>x("/apartments",{query:{page:o,is_active:r.value.is_active===null?void 0:r.value.is_active?1:0,search:r.value.search||void 0},signal:l}));V.value=a.data,p.value=a.meta}catch(a){if(w(a))return;m.value=k(a,"Daire listesi alınamadı.")}finally{g.value=!1}},T=async()=>{await f(1)},F=async()=>{r.value={is_active:null,search:""},await f(1)},S=async o=>{h.value=o.id,m.value="";try{await $(a=>x(`/apartments/${o.id}`,{method:"DELETE",signal:a})),await f(p.value.current_page)}catch(a){if(w(a))return;m.value=k(a,"Daire silinemedi.")}finally{h.value=null}};return L(()=>f(1)),(o,a)=>(v(),D(C,null,{default:s(()=>[e(d,{cols:"12"},{default:s(()=>[t("div",P,[t("div",null,[a[2]||(a[2]=t("h4",{class:"text-h4 mb-1"}," Daireler ",-1)),t("p",Q,i(o.$t("pages.apartments.indexSubtitle")),1)]),e(u,{color:"primary","prepend-icon":"ri-add-line",to:"/management/apartments/create"},{default:s(()=>[...a[3]||(a[3]=[_(" Yeni Daire ",-1)])]),_:1})])]),_:1}),e(d,{cols:"12"},{default:s(()=>[e(A,null,{default:s(()=>[e(B,null,{default:s(()=>[e(C,null,{default:s(()=>[e(d,{cols:"12",md:"3"},{default:s(()=>[e(z,{modelValue:n(r).is_active,"onUpdate:modelValue":a[0]||(a[0]=l=>n(r).is_active=l),items:[{title:o.$t("common.active"),value:!0},{title:o.$t("common.passive"),value:!1}],label:o.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),e(d,{cols:"12",md:"9"},{default:s(()=>[e(N,{modelValue:n(r).search,"onUpdate:modelValue":a[1]||(a[1]=l=>n(r).search=l),label:o.$t("common.search"),placeholder:"Blok, kat, no"},null,8,["modelValue","label"])]),_:1}),e(d,{cols:"12"},{default:s(()=>[t("div",Y,[e(u,{variant:"outlined",onClick:F},{default:s(()=>[_(i(o.$t("common.clear")),1)]),_:1}),e(u,{color:"primary",onClick:T},{default:s(()=>[_(i(o.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(m)?(v(),D(d,{key:0,cols:"12"},{default:s(()=>[e(R,{type:"error",variant:"tonal"},{default:s(()=>[_(i(n(m)),1)]),_:1})]),_:1})):E("",!0),e(d,{cols:"12"},{default:s(()=>[e(A,{loading:n(g)},{default:s(()=>[e(U,{density:"comfortable"},{default:s(()=>[t("thead",null,[t("tr",null,[t("th",null,i(o.$t("common.apartment")),1),t("th",null,i(o.$t("common.resident")),1),a[4]||(a[4]=t("th",{class:"text-right"}," m2 ",-1)),t("th",G,i(o.$t("common.landShare")),1),t("th",null,i(o.$t("common.status")),1),a[5]||(a[5]=t("th",{class:"text-right"}," İşlemler ",-1))])]),t("tbody",null,[(v(!0),b(O,null,K(n(V),l=>(v(),b("tr",{key:l.id},[t("td",null,[t("div",H,i(l.full_label),1),t("div",J," Blok "+i(l.block||"-")+", Kat "+i(l.floor),1)]),t("td",null,[t("div",null,i(l.current_tenant?.name||l.current_owner?.name||"-"),1),t("div",W,i(l.resident_count)+" sakin ",1)]),t("td",X,i(l.m2??"-"),1),t("td",Z,i(l.arsa_payi??"-"),1),t("td",null,[e(q,{size:"small",color:l.is_active?"success":"secondary",variant:"tonal"},{default:s(()=>[_(i(l.is_active?o.$t("common.active"):o.$t("common.passive")),1)]),_:2},1032,["color"])]),t("td",ee,[e(u,{icon:"",size:"small",variant:"text",to:`/management/apartments/${l.id}`},{default:s(()=>[e(y,{icon:"ri-eye-line"})]),_:1},8,["to"]),e(u,{icon:"",size:"small",variant:"text",to:`/management/apartments/${l.id}/edit`},{default:s(()=>[e(y,{icon:"ri-edit-line"})]),_:1},8,["to"]),e(u,{icon:"",size:"small",variant:"text",color:"error",loading:n(h)===l.id,disabled:n(h)===l.id,onClick:oe=>S(l)},{default:s(()=>[e(y,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),n(V).length===0?(v(),b("tr",te,[t("td",ae,i(o.$t("common.noRecords")),1)])):E("",!0)])]),_:1}),e(B,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:s(()=>[t("span",le,i(o.$t("common.totalRecords",{count:n(p).total})),1),e(M,{"model-value":n(p).current_page,length:n(p).last_page,"total-visible":7,"onUpdate:modelValue":f},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ke as default};
