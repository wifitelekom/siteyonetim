import{$,T as x,x as f,q as k}from"./main-DUODoQpR.js";import{u as R,i as w}from"./useAbortOnUnmount-B_TyPYrd.js";import{V as C,a as d}from"./VRow-dBMGxjTF.js";import{V as T}from"./VCard-DEMyauu_.js";import{V as A}from"./VCardText-lEnvPJxp.js";import{V as S}from"./VSelect-BpDYXa0x.js";import{V as U}from"./VTextField-BgtisBQp.js";import{V as q}from"./VAlert-DIbLZTVg.js";import{V as z}from"./VTable-CDiDVqFm.js";import{V as D}from"./VChip-CzUAJTHl.js";import{V as M}from"./VPagination-Dp4qKX6V.js";import{j as I,h as u,D as L,Q as v,R as E,S as l,q as t,y as a,O as i,a8 as _,u as n,ad as F,V as y,F as O,ab as G}from"./vendor-qaEqcc9M.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const P={class:"d-flex align-center justify-space-between mb-2"},Q={class:"text-medium-emphasis mb-0"},Y={class:"d-flex gap-3 justify-end"},H={class:"font-weight-medium"},J={class:"text-caption text-medium-emphasis"},K={class:"text-right"},W={class:"text-right"},X={key:0},Z={colspan:"6",class:"text-center text-medium-emphasis py-6"},ee={class:"text-sm text-medium-emphasis"},be=I({__name:"index",setup(te){const{withAbort:b}=R(),V=u(!1),g=u(null),m=u(""),h=u([]),c=u({current_page:1,last_page:1,per_page:20,total:0}),r=u({is_active:null,search:""}),p=async(s=1)=>{V.value=!0,m.value="";try{const e=await b(o=>$("/vendors",{query:{page:s,is_active:r.value.is_active===null?void 0:r.value.is_active?1:0,search:r.value.search||void 0},signal:o}));h.value=e.data,c.value=e.meta}catch(e){if(w(e))return;m.value=x(e,"Tedarikçi listesi alınamadı.")}finally{V.value=!1}},B=async()=>{await p(1)},N=async()=>{r.value={is_active:null,search:""},await p(1)},j=async s=>{g.value=s.id,m.value="";try{await b(e=>$(`/vendors/${s.id}`,{method:"DELETE",signal:e})),await p(c.value.current_page)}catch(e){if(w(e))return;m.value=x(e,"Tedarikçi silinemedi.")}finally{g.value=null}};return L(()=>p(1)),(s,e)=>(v(),E(C,null,{default:l(()=>[t(d,{cols:"12"},{default:l(()=>[a("div",P,[a("div",null,[e[2]||(e[2]=a("h4",{class:"text-h4 mb-1"}," Tedarikçiler ",-1)),a("p",Q,i(s.$t("pages.vendors.indexSubtitle")),1)]),t(f,{color:"primary","prepend-icon":"ri-add-line",to:"/management/vendors/create"},{default:l(()=>[...e[3]||(e[3]=[_(" Yeni Tedarikçi ",-1)])]),_:1})])]),_:1}),t(d,{cols:"12"},{default:l(()=>[t(T,null,{default:l(()=>[t(A,null,{default:l(()=>[t(C,null,{default:l(()=>[t(d,{cols:"12",md:"3"},{default:l(()=>[t(S,{modelValue:n(r).is_active,"onUpdate:modelValue":e[0]||(e[0]=o=>n(r).is_active=o),items:[{title:s.$t("common.active"),value:!0},{title:s.$t("common.passive"),value:!1}],label:s.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),t(d,{cols:"12",md:"9"},{default:l(()=>[t(U,{modelValue:n(r).search,"onUpdate:modelValue":e[1]||(e[1]=o=>n(r).search=o),label:s.$t("common.search"),placeholder:"Ad, vergi no, telefon, e-posta"},null,8,["modelValue","label"])]),_:1}),t(d,{cols:"12"},{default:l(()=>[a("div",Y,[t(f,{variant:"outlined",onClick:N},{default:l(()=>[_(i(s.$t("common.clear")),1)]),_:1}),t(f,{color:"primary",onClick:B},{default:l(()=>[_(i(s.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(m)?(v(),E(d,{key:0,cols:"12"},{default:l(()=>[t(q,{type:"error",variant:"tonal"},{default:l(()=>[_(i(n(m)),1)]),_:1})]),_:1})):F("",!0),t(d,{cols:"12"},{default:l(()=>[t(T,{loading:n(V)},{default:l(()=>[t(z,{density:"comfortable"},{default:l(()=>[a("thead",null,[a("tr",null,[e[4]||(e[4]=a("th",null,"Firma",-1)),e[5]||(e[5]=a("th",null,"Vergi No",-1)),a("th",null,i(s.$t("common.contact")),1),e[6]||(e[6]=a("th",{class:"text-right"}," Gider ",-1)),a("th",null,i(s.$t("common.status")),1),e[7]||(e[7]=a("th",{class:"text-right"}," İşlemler ",-1))])]),a("tbody",null,[(v(!0),y(O,null,G(n(h),o=>(v(),y("tr",{key:o.id},[a("td",null,[a("div",H,i(o.name),1),a("div",J,i(o.email||"-"),1)]),a("td",null,i(o.tax_no||"-"),1),a("td",null,i(o.phone||"-"),1),a("td",K,i(o.expenses_count),1),a("td",null,[t(D,{size:"small",color:o.is_active?"success":"secondary",variant:"tonal"},{default:l(()=>[_(i(o.is_active?s.$t("common.active"):s.$t("common.passive")),1)]),_:2},1032,["color"])]),a("td",W,[t(f,{icon:"",size:"small",variant:"text",to:`/management/vendors/${o.id}/edit`},{default:l(()=>[t(k,{icon:"ri-edit-line"})]),_:1},8,["to"]),t(f,{icon:"",size:"small",variant:"text",color:"error",loading:n(g)===o.id,disabled:n(g)===o.id,onClick:ae=>j(o)},{default:l(()=>[t(k,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),n(h).length===0?(v(),y("tr",X,[a("td",Z,i(s.$t("common.noRecords")),1)])):F("",!0)])]),_:1}),t(A,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[a("span",ee,i(s.$t("common.totalRecords",{count:n(c).total})),1),t(M,{"model-value":n(c).current_page,length:n(c).last_page,"total-visible":7,"onUpdate:modelValue":p},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{be as default};
