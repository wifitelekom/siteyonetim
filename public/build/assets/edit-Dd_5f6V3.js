import{j as M,f as j,h as m,D as q,Q as D,R,S as r,Z as z,ac as I,q as t,y as f,u as a,a8 as c,ag as K,O as V,ad as O}from"./vendor-DfCbaU-T.js";import{$ as _,T as k,x as y,U as P}from"./main-Btr01hqQ.js";import{V as L,r as N,p as Q}from"./VForm-D0fBkA3g.js";import{u as Z}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as U,a as n}from"./VRow-CRn_xzm0.js";import{V as G}from"./VCard-BmPLTxO3.js";import{V as H}from"./VCardText-H2SttjXr.js";import{V as J}from"./VAlert-R8JWKysv.js";import{V as b}from"./VTextField-pVQuWnMO.js";import{V as W}from"./VSwitch-Blte16Xl.js";import"./vuetify-DGZOXKNZ.js";import"./VAvatar-96oJdN2D.js";import"./VSelectionControl-ClrOpdq3.js";const X={class:"d-flex align-center justify-space-between mb-2"},Y={class:"d-flex gap-2"},ee={class:"d-flex justify-end gap-3"},be=M({__name:"edit",setup(ae){const x=z(),$=I(),{withAbort:C}=Z(),d=j(()=>Number(x.params.id)),g=m(!1),p=m(!1),v=m(!1),u=m(""),i=m({}),o=m({block:"",floor:null,number:"",m2:null,arsa_payi:null,is_active:!0}),w=m(null),S=[N(),e=>Number.isInteger(Number(e))?!0:"Kat bilgisi tam sayi olmalidir."],A=[N()],E=[e=>e==null||e===""?!0:Q()(e)],T=[e=>{if(e==null||e==="")return!0;const l=Number(e);return Number.isFinite(l)&&l>=0?!0:"Sifir veya daha buyuk bir deger giriniz."}],B=async()=>{g.value=!0,u.value="";try{const e=await C(l=>_(`/apartments/${d.value}`,{signal:l}));o.value={block:e.data.block??"",floor:e.data.floor,number:e.data.number,m2:e.data.m2,arsa_payi:e.data.arsa_payi,is_active:e.data.is_active}}catch(e){u.value=k(e,"Daire detayı alınamadı.")}finally{g.value=!1}},h=async()=>{if((await w.value?.validate())?.valid){p.value=!0,u.value="",i.value={};try{await _(`/apartments/${d.value}`,{method:"PUT",body:{block:o.value.block||null,floor:o.value.floor,number:o.value.number,m2:o.value.m2,arsa_payi:o.value.arsa_payi,is_active:o.value.is_active}}),await $.push(`/management/apartments/${d.value}`)}catch(l){u.value=k(l,"Daire güncellenemedi."),i.value=P(l)}finally{p.value=!1}}},F=async()=>{v.value=!0,u.value="";try{await _(`/apartments/${d.value}`,{method:"DELETE"}),await $.push("/management/apartments")}catch(e){u.value=k(e,"Daire silinemedi.")}finally{v.value=!1}};return q(B),(e,l)=>(D(),R(U,null,{default:r(()=>[t(n,{cols:"12"},{default:r(()=>[f("div",X,[l[8]||(l[8]=f("div",null,[f("h4",{class:"text-h4 mb-1"}," Daire Düzenle "),f("p",{class:"text-medium-emphasis mb-0"}," Daire kaydını güncelleyin ")],-1)),f("div",Y,[t(y,{variant:"outlined",to:`/management/apartments/${a(d)}`},{default:r(()=>[...l[6]||(l[6]=[c(" Detaya Don ",-1)])]),_:1},8,["to"]),t(y,{color:"error",variant:"outlined",loading:a(v),disabled:a(v),onClick:F},{default:r(()=>[...l[7]||(l[7]=[c(" Sil ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(G,{loading:a(g)||a(p)},{default:r(()=>[t(H,null,{default:r(()=>[t(L,{ref_key:"formRef",ref:w,onSubmit:K(h,["prevent"])},{default:r(()=>[t(U,null,{default:r(()=>[a(u)?(D(),R(n,{key:0,cols:"12"},{default:r(()=>[t(J,{type:"error",variant:"tonal"},{default:r(()=>[c(V(a(u)),1)]),_:1})]),_:1})):O("",!0),t(n,{cols:"12",md:"4"},{default:r(()=>[t(b,{modelValue:a(o).block,"onUpdate:modelValue":l[0]||(l[0]=s=>a(o).block=s),label:"Blok","error-messages":a(i).block??[]},null,8,["modelValue","error-messages"])]),_:1}),t(n,{cols:"12",md:"4"},{default:r(()=>[t(b,{modelValue:a(o).floor,"onUpdate:modelValue":l[1]||(l[1]=s=>a(o).floor=s),type:"number",label:"Kat",rules:S,"error-messages":a(i).floor??[]},null,8,["modelValue","error-messages"])]),_:1}),t(n,{cols:"12",md:"4"},{default:r(()=>[t(b,{modelValue:a(o).number,"onUpdate:modelValue":l[2]||(l[2]=s=>a(o).number=s),label:e.$t("common.apartmentNo"),rules:A,"error-messages":a(i).number??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(n,{cols:"12",md:"6"},{default:r(()=>[t(b,{modelValue:a(o).m2,"onUpdate:modelValue":l[3]||(l[3]=s=>a(o).m2=s),type:"number",min:"1",step:"0.01",label:"m2",rules:E,"error-messages":a(i).m2??[]},null,8,["modelValue","error-messages"])]),_:1}),t(n,{cols:"12",md:"6"},{default:r(()=>[t(b,{modelValue:a(o).arsa_payi,"onUpdate:modelValue":l[4]||(l[4]=s=>a(o).arsa_payi=s),type:"number",min:"0",step:"0.000001",label:e.$t("common.landShare"),rules:T,"error-messages":a(i).arsa_payi??[]},null,8,["modelValue","label","error-messages"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(W,{modelValue:a(o).is_active,"onUpdate:modelValue":l[5]||(l[5]=s=>a(o).is_active=s),label:e.$t("common.active"),color:"primary"},null,8,["modelValue","label"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[f("div",ee,[t(y,{variant:"outlined",to:`/management/apartments/${a(d)}`},{default:r(()=>[c(V(e.$t("common.cancel")),1)]),_:1},8,["to"]),t(y,{color:"primary",type:"submit",loading:a(p),disabled:a(p)},{default:r(()=>[c(V(e.$t("common.update")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{be as default};
