import{u as E,i as w}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as C,T as D,x as c,p as $}from"./main-OjHNd2U9.js";import{a as q,f as y}from"./formatters-BEv4aA23.js";import{c as I,a as K}from"./statusHelpers-B7BIhNzn.js";import{V as A,a as n}from"./VRow-Ba58lXtG.js";import{V as F}from"./VCard-9RfFlHpT.js";import{V as S}from"./VCardText-YweTyZzP.js";import{V as U}from"./VTextField-CMxHKe9w.js";import{V as B}from"./VSelect-CMe3Xagq.js";import{V as L}from"./VAlert-DafHPFjN.js";import{V as P}from"./VTable-ByowNMkP.js";import{V as R}from"./VChip-CnrRRXXG.js";import{V as Q}from"./VPagination-Laqr3CkN.js";import{j as Y,h as d,D as G,Q as f,R as M,S as s,q as a,y as e,a8 as m,u as l,O as r,ad as j,V as x,F as H,ab as J}from"./vendor-DfCbaU-T.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const W={class:"d-flex align-center justify-space-between mb-2"},X={class:"d-flex gap-2"},Z={class:"d-flex gap-3 justify-end"},tt={class:"font-weight-medium"},et={class:"text-caption text-medium-emphasis"},at={class:"text-caption text-medium-emphasis"},lt={class:"text-right"},st={class:"text-right"},ot={class:"text-right"},it={class:"text-right"},rt={key:0},nt={class:"text-sm text-medium-emphasis"},St=Y({__name:"index",setup(dt){const V=d(!1),h=d(!1),p=d(""),g=d([]),k=d([]),b=d([]),_=d({current_page:1,last_page:1,per_page:15,total:0}),i=d({period:"",apartment_id:null,status:null,search:""}),{withAbort:T}=E(),N=async()=>{h.value=!0;try{const u=await T(t=>C("/charges/meta",{signal:t}));k.value=u.data.apartments}catch(u){if(w(u))return;p.value=D(u,"Filtre verileri alinamadi.")}finally{h.value=!1}},v=async(u=1)=>{V.value=!0,p.value="";try{const t=await T(o=>C("/charges",{query:{page:u,period:i.value.period||void 0,apartment_id:i.value.apartment_id||void 0,status:i.value.status||void 0,search:i.value.search||void 0},signal:o}));g.value=t.data,_.value=t.meta,b.value=t.filters.status}catch(t){if(w(t))return;p.value=D(t,"Tahakkuk listesi alinamadi.")}finally{V.value=!1}},O=async()=>{await v(1)},z=async()=>{i.value={period:"",apartment_id:null,status:null,search:""},await v(1)};return G(async()=>{await Promise.allSettled([N(),v(1)])}),(u,t)=>(f(),M(A,null,{default:s(()=>[a(n,{cols:"12"},{default:s(()=>[e("div",W,[t[6]||(t[6]=e("div",null,[e("h4",{class:"text-h4 mb-1"}," Tahakkuklar "),e("p",{class:"text-medium-emphasis mb-0"}," Tahakkuk kayitlarini filtreleyin ve yonetin ")],-1)),e("div",X,[a(c,{variant:"outlined","prepend-icon":"ri-stack-line",to:"/charges/create-bulk"},{default:s(()=>[...t[4]||(t[4]=[m(" Toplu Tahakkuk ",-1)])]),_:1}),a(c,{color:"primary","prepend-icon":"ri-add-line",to:"/charges/create"},{default:s(()=>[...t[5]||(t[5]=[m(" Yeni Tahakkuk ",-1)])]),_:1})])])]),_:1}),a(n,{cols:"12"},{default:s(()=>[a(F,{loading:l(h)},{default:s(()=>[a(S,null,{default:s(()=>[a(A,null,{default:s(()=>[a(n,{cols:"12",md:"3"},{default:s(()=>[a(U,{modelValue:l(i).period,"onUpdate:modelValue":t[0]||(t[0]=o=>l(i).period=o),type:"month",label:"Donem"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"3"},{default:s(()=>[a(B,{modelValue:l(i).apartment_id,"onUpdate:modelValue":t[1]||(t[1]=o=>l(i).apartment_id=o),items:l(k),"item-title":"label","item-value":"id",label:"Daire",clearable:""},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"3"},{default:s(()=>[a(B,{modelValue:l(i).status,"onUpdate:modelValue":t[2]||(t[2]=o=>l(i).status=o),items:l(b),"item-title":"label","item-value":"value",label:"Durum",clearable:""},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",md:"3"},{default:s(()=>[a(U,{modelValue:l(i).search,"onUpdate:modelValue":t[3]||(t[3]=o=>l(i).search=o),label:"Arama",placeholder:"Aciklama veya daire"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:s(()=>[e("div",Z,[a(c,{variant:"outlined",onClick:z},{default:s(()=>[...t[7]||(t[7]=[m(" Temizle ",-1)])]),_:1}),a(c,{color:"primary",onClick:O},{default:s(()=>[...t[8]||(t[8]=[m(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1}),l(p)?(f(),M(n,{key:0,cols:"12"},{default:s(()=>[a(L,{type:"error",variant:"tonal"},{default:s(()=>[m(r(l(p)),1)]),_:1})]),_:1})):j("",!0),a(n,{cols:"12"},{default:s(()=>[a(F,{loading:l(V)},{default:s(()=>[a(P,{density:"comfortable"},{default:s(()=>[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",null,"Daire"),e("th",null,"Donem / Vade"),e("th",{class:"text-right"}," Tutar "),e("th",{class:"text-right"}," Odenen "),e("th",{class:"text-right"}," Kalan "),e("th",null,"Durum"),e("th",{class:"text-right"}," Islemler ")])],-1)),e("tbody",null,[(f(!0),x(H,null,J(l(g),o=>(f(),x("tr",{key:o.id},[e("td",null,[e("div",tt,r(o.apartment?.label??"-"),1),e("div",et,r(o.account?.name??"-"),1)]),e("td",null,[e("div",null,r(o.period),1),e("div",at,r(l(q)(o.due_date)),1)]),e("td",lt,r(l(y)(o.amount)),1),e("td",st,r(l(y)(o.paid_amount)),1),e("td",ot,r(l(y)(o.remaining)),1),e("td",null,[a(R,{size:"small",color:l(I)(o.status),variant:"tonal"},{default:s(()=>[m(r(l(K)(o.status)),1)]),_:2},1032,["color"])]),e("td",it,[a(c,{icon:"",size:"small",variant:"text",to:`/charges/${o.id}`},{default:s(()=>[a($,{icon:"ri-eye-line"})]),_:1},8,["to"])])]))),128)),l(g).length===0?(f(),x("tr",rt,[...t[9]||(t[9]=[e("td",{colspan:"7",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):j("",!0)])]),_:1}),a(S,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:s(()=>[e("span",nt,"Toplam "+r(l(_).total)+" kayit",1),a(Q,{"model-value":l(_).current_page,length:l(_).last_page,"total-visible":7,"onUpdate:modelValue":v},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{St as default};
