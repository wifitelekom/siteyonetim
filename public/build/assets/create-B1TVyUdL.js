import{j as N,h as m,D as O,Q as b,R as k,S as o,ac as j,q as a,y as V,a8 as v,u as l,ag as D,O as F,ad as q}from"./vendor-DfCbaU-T.js";import{u as $,i as R}from"./useAbortOnUnmount-D2zdVzb9.js";import{$ as x,T as S,x as w,U as I}from"./main-OjHNd2U9.js";import{V as P,r as g,c as Q,e as Y,a as z,m as G,b as H}from"./VForm-CtC6ldpE.js";import{V as U,a as t}from"./VRow-Ba58lXtG.js";import{V as J}from"./VCard-9RfFlHpT.js";import{V as W}from"./VCardText-YweTyZzP.js";import{V as X}from"./VAlert-DafHPFjN.js";import{V as n}from"./VTextField-CMxHKe9w.js";import{V as Z}from"./VSelect-CMe3Xagq.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";import"./VChip-CnrRRXXG.js";const ee={class:"d-flex align-center justify-space-between mb-2"},le={class:"d-flex justify-end gap-3"},_e=N({__name:"create",setup(ae){const{withAbort:y}=$(),C=j(),c=m(!1),d=m(!1),p=m(""),i=m({}),f=m([]),s=m({name:"",email:"",phone:"",tc_kimlik:"",password:"",password_confirmation:"",role:"owner"}),_=m(null),T=[g(),Q(100)],A=[g(),Y()],h=[u=>typeof u!="string"||u.length===0?!0:z(11)(u)],K=[g(),G(8)],M=[g(),H(()=>s.value.password,"Sifreler eslesmiyor.")],E=[g()],B=async()=>{c.value=!0;try{const u=await y(e=>x("/users/meta",{signal:e}));f.value=u.data.roles,f.value.length>0&&!f.value.some(e=>e.value===s.value.role)&&(s.value.role=f.value[0].value)}catch(u){if(R(u))return;p.value=S(u,"Rol listesi alinamadi.")}finally{c.value=!1}},L=async()=>{if((await _.value?.validate())?.valid){d.value=!0,p.value="",i.value={};try{await y(e=>x("/users",{method:"POST",body:{name:s.value.name,email:s.value.email,phone:s.value.phone||null,tc_kimlik:s.value.tc_kimlik||null,password:s.value.password,password_confirmation:s.value.password_confirmation,role:s.value.role},signal:e})),await C.push("/management/users")}catch(e){if(R(e))return;p.value=S(e,"Kullanici olusturulamadi."),i.value=I(e)}finally{d.value=!1}}};return O(B),(u,e)=>(b(),k(U,null,{default:o(()=>[a(t,{cols:"12"},{default:o(()=>[V("div",ee,[e[8]||(e[8]=V("div",null,[V("h4",{class:"text-h4 mb-1"}," Yeni Kullanici "),V("p",{class:"text-medium-emphasis mb-0"}," Kullanici kaydi olusturun ")],-1)),a(w,{variant:"outlined",to:"/management/users"},{default:o(()=>[...e[7]||(e[7]=[v(" Listeye Don ",-1)])]),_:1})])]),_:1}),a(t,{cols:"12"},{default:o(()=>[a(J,{loading:l(d)||l(c)},{default:o(()=>[a(W,null,{default:o(()=>[a(P,{ref_key:"formRef",ref:_,onSubmit:D(L,["prevent"])},{default:o(()=>[a(U,null,{default:o(()=>[l(p)?(b(),k(t,{key:0,cols:"12"},{default:o(()=>[a(X,{type:"error",variant:"tonal"},{default:o(()=>[v(F(l(p)),1)]),_:1})]),_:1})):q("",!0),a(t,{cols:"12",md:"6"},{default:o(()=>[a(n,{modelValue:l(s).name,"onUpdate:modelValue":e[0]||(e[0]=r=>l(s).name=r),label:"Ad Soyad",rules:T,"error-messages":l(i).name??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"6"},{default:o(()=>[a(n,{modelValue:l(s).email,"onUpdate:modelValue":e[1]||(e[1]=r=>l(s).email=r),type:"email",label:"E-posta",rules:A,"error-messages":l(i).email??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"6"},{default:o(()=>[a(n,{modelValue:l(s).phone,"onUpdate:modelValue":e[2]||(e[2]=r=>l(s).phone=r),label:"Telefon","error-messages":l(i).phone??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"6"},{default:o(()=>[a(n,{modelValue:l(s).tc_kimlik,"onUpdate:modelValue":e[3]||(e[3]=r=>l(s).tc_kimlik=r),label:"TC Kimlik",maxlength:"11",rules:h,"error-messages":l(i).tc_kimlik??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"4"},{default:o(()=>[a(n,{modelValue:l(s).password,"onUpdate:modelValue":e[4]||(e[4]=r=>l(s).password=r),type:"password",label:"Sifre",rules:K,"error-messages":l(i).password??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"4"},{default:o(()=>[a(n,{modelValue:l(s).password_confirmation,"onUpdate:modelValue":e[5]||(e[5]=r=>l(s).password_confirmation=r),type:"password",label:"Sifre Tekrar",rules:M,"error-messages":l(i).password_confirmation??[]},null,8,["modelValue","error-messages"])]),_:1}),a(t,{cols:"12",md:"4"},{default:o(()=>[a(Z,{modelValue:l(s).role,"onUpdate:modelValue":e[6]||(e[6]=r=>l(s).role=r),items:l(f),"item-title":"label","item-value":"value",label:"Rol",rules:E,"error-messages":l(i).role??[]},null,8,["modelValue","items","error-messages"])]),_:1}),a(t,{cols:"12"},{default:o(()=>[V("div",le,[a(w,{variant:"outlined",to:"/management/users"},{default:o(()=>[...e[9]||(e[9]=[v(" Iptal ",-1)])]),_:1}),a(w,{color:"primary",type:"submit",loading:l(d),disabled:l(d)},{default:o(()=>[...e[10]||(e[10]=[v(" Kaydet ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{_e as default};
