import{$ as k,T as w,x as u,p as y}from"./main-OjHNd2U9.js";import{u as j,i as A}from"./useAbortOnUnmount-D2zdVzb9.js";import{V as C,a as n}from"./VRow-Ba58lXtG.js";import{V as D}from"./VCard-9RfFlHpT.js";import{V as T}from"./VCardText-YweTyZzP.js";import{V as N}from"./VSelect-CMe3Xagq.js";import{V as P}from"./VTextField-CMxHKe9w.js";import{V as S}from"./VAlert-DafHPFjN.js";import{V as U}from"./VTable-ByowNMkP.js";import{V as I}from"./VChip-CnrRRXXG.js";import{V as M}from"./VPagination-Laqr3CkN.js";import{j as q,h as c,D as K,Q as _,R as B,S as i,q as t,y as a,a8 as v,u as s,O as o,ad as E,V as x,F as L,ab as O}from"./vendor-DfCbaU-T.js";import"./vuetify-BWJcAN87.js";import"./VAvatar-BcaC_ZEa.js";import"./VList-B1ov9hmg.js";import"./VDivider-CUijZXd4.js";import"./VCheckboxBtn-B6JwM7Rr.js";import"./VSelectionControl-Ck2LTPqY.js";const R={class:"d-flex align-center justify-space-between mb-2"},Q={class:"d-flex gap-3 justify-end"},Y={class:"font-weight-medium"},G={class:"text-caption text-medium-emphasis"},H={class:"text-caption text-medium-emphasis"},J={class:"text-right"},W={class:"text-right"},X={class:"text-right"},Z={key:0},ee={class:"text-sm text-medium-emphasis"},xe=q({__name:"index",setup(te){const{withAbort:b}=j(),h=c(!1),g=c(null),d=c(""),V=c([]),m=c({current_page:1,last_page:1,per_page:20,total:0}),r=c({is_active:null,search:""}),f=async(p=1)=>{h.value=!0,d.value="";try{const e=await b(l=>k("/apartments",{query:{page:p,is_active:r.value.is_active===null?void 0:r.value.is_active?1:0,search:r.value.search||void 0},signal:l}));V.value=e.data,m.value=e.meta}catch(e){if(A(e))return;d.value=w(e,"Daire listesi alinamadi.")}finally{h.value=!1}},F=async()=>{await f(1)},$=async()=>{r.value={is_active:null,search:""},await f(1)},z=async p=>{g.value=p.id,d.value="";try{await b(e=>k(`/apartments/${p.id}`,{method:"DELETE",signal:e})),await f(m.value.current_page)}catch(e){if(A(e))return;d.value=w(e,"Daire silinemedi.")}finally{g.value=null}};return K(()=>f(1)),(p,e)=>(_(),B(C,null,{default:i(()=>[t(n,{cols:"12"},{default:i(()=>[a("div",R,[e[3]||(e[3]=a("div",null,[a("h4",{class:"text-h4 mb-1"}," Daireler "),a("p",{class:"text-medium-emphasis mb-0"}," Daire kayitlarini yonetin ")],-1)),t(u,{color:"primary","prepend-icon":"ri-add-line",to:"/management/apartments/create"},{default:i(()=>[...e[2]||(e[2]=[v(" Yeni Daire ",-1)])]),_:1})])]),_:1}),t(n,{cols:"12"},{default:i(()=>[t(D,null,{default:i(()=>[t(T,null,{default:i(()=>[t(C,null,{default:i(()=>[t(n,{cols:"12",md:"3"},{default:i(()=>[t(N,{modelValue:s(r).is_active,"onUpdate:modelValue":e[0]||(e[0]=l=>s(r).is_active=l),items:[{title:"Aktif",value:!0},{title:"Pasif",value:!1}],label:"Durum",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"9"},{default:i(()=>[t(P,{modelValue:s(r).search,"onUpdate:modelValue":e[1]||(e[1]=l=>s(r).search=l),label:"Arama",placeholder:"Blok, kat, no"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12"},{default:i(()=>[a("div",Q,[t(u,{variant:"outlined",onClick:$},{default:i(()=>[...e[4]||(e[4]=[v(" Temizle ",-1)])]),_:1}),t(u,{color:"primary",onClick:F},{default:i(()=>[...e[5]||(e[5]=[v(" Filtrele ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d)?(_(),B(n,{key:0,cols:"12"},{default:i(()=>[t(S,{type:"error",variant:"tonal"},{default:i(()=>[v(o(s(d)),1)]),_:1})]),_:1})):E("",!0),t(n,{cols:"12"},{default:i(()=>[t(D,{loading:s(h)},{default:i(()=>[t(U,{density:"comfortable"},{default:i(()=>[e[7]||(e[7]=a("thead",null,[a("tr",null,[a("th",null,"Daire"),a("th",null,"Sakin"),a("th",{class:"text-right"}," m2 "),a("th",{class:"text-right"}," Arsa Payi "),a("th",null,"Durum"),a("th",{class:"text-right"}," Islemler ")])],-1)),a("tbody",null,[(_(!0),x(L,null,O(s(V),l=>(_(),x("tr",{key:l.id},[a("td",null,[a("div",Y,o(l.full_label),1),a("div",G," Blok "+o(l.block||"-")+", Kat "+o(l.floor),1)]),a("td",null,[a("div",null,o(l.current_tenant?.name||l.current_owner?.name||"-"),1),a("div",H,o(l.resident_count)+" sakin ",1)]),a("td",J,o(l.m2??"-"),1),a("td",W,o(l.arsa_payi??"-"),1),a("td",null,[t(I,{size:"small",color:l.is_active?"success":"secondary",variant:"tonal"},{default:i(()=>[v(o(l.is_active?"Aktif":"Pasif"),1)]),_:2},1032,["color"])]),a("td",X,[t(u,{icon:"",size:"small",variant:"text",to:`/management/apartments/${l.id}`},{default:i(()=>[t(y,{icon:"ri-eye-line"})]),_:1},8,["to"]),t(u,{icon:"",size:"small",variant:"text",to:`/management/apartments/${l.id}/edit`},{default:i(()=>[t(y,{icon:"ri-edit-line"})]),_:1},8,["to"]),t(u,{icon:"",size:"small",variant:"text",color:"error",loading:s(g)===l.id,disabled:s(g)===l.id,onClick:ae=>z(l)},{default:i(()=>[t(y,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),s(V).length===0?(_(),x("tr",Z,[...e[6]||(e[6]=[a("td",{colspan:"6",class:"text-center text-medium-emphasis py-6"}," Kayit bulunamadi. ",-1)])])):E("",!0)])]),_:1}),t(T,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:i(()=>[a("span",ee,"Toplam "+o(s(m).total)+" kayit",1),t(M,{"model-value":s(m).current_page,length:s(m).last_page,"total-visible":7,"onUpdate:modelValue":f},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{xe as default};
