import{$ as B,T as z,x as p,q as x}from"./main-DUODoQpR.js";import{f as N}from"./formatters-BEv4aA23.js";import{u as S,i as A}from"./useAbortOnUnmount-B_TyPYrd.js";import{V as D,a as m}from"./VRow-dBMGxjTF.js";import{V as E}from"./VCard-DEMyauu_.js";import{V as R}from"./VCardText-lEnvPJxp.js";import{V as U}from"./VSelect-BpDYXa0x.js";import{V as q}from"./VTextField-BgtisBQp.js";import{V as I}from"./VAlert-DIbLZTVg.js";import{V as K}from"./VTable-CDiDVqFm.js";import{V as T}from"./VChip-CzUAJTHl.js";import{V as O}from"./VPagination-Dp4qKX6V.js";import{j as G,h as _,D as P,Q as r,R as y,S as l,a0 as Q,q as a,y as s,O as n,a8 as d,u as i,ad as $,V as c,F as Y,ab as H,x as J}from"./vendor-qaEqcc9M.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";import"./VList-BpKoOtV6.js";import"./VDivider-CiCMqi-4.js";import"./VCheckboxBtn-B_mUIJHa.js";import"./VSelectionControl-DtdcpgRj.js";const W={class:"d-flex align-center justify-space-between mb-2"},X={class:"text-medium-emphasis mb-0"},Z={class:"d-flex gap-3 justify-end"},ee={key:0,class:"text-caption text-medium-emphasis"},te={key:1,class:"text-medium-emphasis"},ae={key:1,class:"text-medium-emphasis"},le={key:1,class:"text-medium-emphasis"},se={class:"text-right"},oe={class:"text-right"},ne={key:0},ie={colspan:"7",class:"text-center text-medium-emphasis py-6"},re={class:"text-sm text-medium-emphasis"},De=G({__name:"index",setup(de){const{withAbort:w}=S(),b=_(!1),V=_(null),f=_(""),k=_([]),v=_({current_page:1,last_page:1,per_page:20,total:0}),u=_({is_active:null,search:""}),g=async(o=1)=>{b.value=!0,f.value="";try{const e=await w(h=>B("/apartments",{query:{page:o,is_active:u.value.is_active===null?void 0:u.value.is_active?1:0,search:u.value.search||void 0},signal:h}));k.value=e.data,v.value=e.meta}catch(e){if(A(e))return;f.value=z(e,"Daire listesi alınamadı.")}finally{b.value=!1}},F=async()=>{await g(1)},L=async()=>{u.value={is_active:null,search:""},await g(1)},C=o=>o?.trim()??"",j=o=>{const e=C(o);return e!==""&&e!=="-"&&e.toLowerCase()!=="null"},M=async o=>{V.value=o.id,f.value="";try{await w(e=>B(`/apartments/${o.id}`,{method:"DELETE",signal:e})),await g(v.value.current_page)}catch(e){if(A(e))return;f.value=z(e,"Daire silinemedi.")}finally{V.value=null}};return P(()=>g(1)),(o,e)=>{const h=Q("RouterLink");return r(),y(D,null,{default:l(()=>[a(m,{cols:"12"},{default:l(()=>[s("div",W,[s("div",null,[e[2]||(e[2]=s("h4",{class:"text-h4 mb-1"}," Daireler ",-1)),s("p",X,n(o.$t("pages.apartments.indexSubtitle")),1)]),a(p,{color:"primary","prepend-icon":"ri-add-line",to:"/management/apartments/create"},{default:l(()=>[...e[3]||(e[3]=[d(" Yeni Daire ",-1)])]),_:1})])]),_:1}),a(m,{cols:"12"},{default:l(()=>[a(E,null,{default:l(()=>[a(R,null,{default:l(()=>[a(D,null,{default:l(()=>[a(m,{cols:"12",md:"3"},{default:l(()=>[a(U,{modelValue:i(u).is_active,"onUpdate:modelValue":e[0]||(e[0]=t=>i(u).is_active=t),items:[{title:o.$t("common.active"),value:!0},{title:o.$t("common.passive"),value:!1}],label:o.$t("common.status"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),a(m,{cols:"12",md:"9"},{default:l(()=>[a(q,{modelValue:i(u).search,"onUpdate:modelValue":e[1]||(e[1]=t=>i(u).search=t),label:o.$t("common.search"),placeholder:"Blok, kat, no"},null,8,["modelValue","label"])]),_:1}),a(m,{cols:"12"},{default:l(()=>[s("div",Z,[a(p,{variant:"outlined",onClick:L},{default:l(()=>[d(n(o.$t("common.clear")),1)]),_:1}),a(p,{color:"primary",onClick:F},{default:l(()=>[d(n(o.$t("common.filter")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(f)?(r(),y(m,{key:0,cols:"12"},{default:l(()=>[a(I,{type:"error",variant:"tonal"},{default:l(()=>[d(n(i(f)),1)]),_:1})]),_:1})):$("",!0),a(m,{cols:"12"},{default:l(()=>[a(E,{loading:i(b)},{default:l(()=>[a(K,{density:"comfortable"},{default:l(()=>[s("thead",null,[s("tr",null,[s("th",null,n(o.$t("common.apartment")),1),e[4]||(e[4]=s("th",null,"Grup",-1)),e[5]||(e[5]=s("th",null,"Kat Maliki",-1)),e[6]||(e[6]=s("th",null,"Kiraci",-1)),e[7]||(e[7]=s("th",{class:"text-right"}," Bakiye ",-1)),s("th",null,n(o.$t("common.status")),1),e[8]||(e[8]=s("th",{class:"text-right"}," Islemler ",-1))])]),s("tbody",null,[(r(!0),c(Y,null,H(i(k),t=>(r(),c("tr",{key:t.id},[s("td",null,[a(h,{to:`/management/apartments/${t.id}`,class:"font-weight-medium text-primary text-decoration-underline d-inline-block"},{default:l(()=>[d(n(t.full_label),1)]),_:2},1032,["to"]),j(t.block)?(r(),c("div",ee," Blok "+n(C(t.block)),1)):$("",!0)]),s("td",null,[t.group?(r(),y(T,{key:0,size:"small",variant:"tonal"},{default:l(()=>[d(n(t.group.name),1)]),_:2},1024)):(r(),c("span",te,"-"))]),s("td",null,[t.current_owner?(r(),y(h,{key:0,to:`/management/users/${t.current_owner.id}`,class:"text-decoration-none"},{default:l(()=>[d(n(t.current_owner.name),1)]),_:2},1032,["to"])):(r(),c("span",ae,"-"))]),s("td",null,[t.current_tenant?(r(),y(h,{key:0,to:`/management/users/${t.current_tenant.id}`,class:"text-decoration-none"},{default:l(()=>[d(n(t.current_tenant.name),1)]),_:2},1032,["to"])):(r(),c("span",le,"-"))]),s("td",se,[s("span",{class:J(["font-weight-medium",t.balance>0?"text-error":t.balance<0?"text-success":""])},n(i(N)(t.balance)),3)]),s("td",null,[a(T,{size:"small",color:t.is_active?"success":"secondary",variant:"tonal"},{default:l(()=>[d(n(t.is_active?o.$t("common.active"):o.$t("common.passive")),1)]),_:2},1032,["color"])]),s("td",oe,[a(p,{icon:"",size:"small",variant:"text",to:`/management/apartments/${t.id}`},{default:l(()=>[a(x,{icon:"ri-eye-line"})]),_:1},8,["to"]),a(p,{icon:"",size:"small",variant:"text",to:`/management/apartments/${t.id}/edit`},{default:l(()=>[a(x,{icon:"ri-edit-line"})]),_:1},8,["to"]),a(p,{icon:"",size:"small",variant:"text",color:"error",loading:i(V)===t.id,disabled:i(V)===t.id,onClick:ue=>M(t)},{default:l(()=>[a(x,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),i(k).length===0?(r(),c("tr",ne,[s("td",ie,n(o.$t("common.noRecords")),1)])):$("",!0)])]),_:1}),a(R,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[s("span",re,n(o.$t("common.totalRecords",{count:i(v).total})),1),a(O,{"model-value":i(v).current_page,length:i(v).last_page,"total-visible":7,"onUpdate:modelValue":g},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}});export{De as default};
