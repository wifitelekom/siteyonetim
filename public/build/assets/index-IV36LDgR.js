import{u as A,i as x}from"./useAbortOnUnmount-B_TyPYrd.js";import{$ as b,T as w,x as h,q as k}from"./main-DUODoQpR.js";import{a as $}from"./formatters-BEv4aA23.js";import{V as B,a as y}from"./VRow-dBMGxjTF.js";import{V as E}from"./VAlert-DIbLZTVg.js";import{V as z}from"./VCard-DEMyauu_.js";import{V as N}from"./VTable-CDiDVqFm.js";import{V as R}from"./VChip-CzUAJTHl.js";import{V as j}from"./VCardText-lEnvPJxp.js";import{V as q}from"./VPagination-Dp4qKX6V.js";import{j as I,h as d,D as M,Q as c,R as C,S as l,q as n,y as e,a8 as g,u as s,O as o,ad as D,V as v,F as O,ab as S}from"./vendor-qaEqcc9M.js";import"./vuetify-CYvz9UpR.js";import"./VAvatar-DfdxhEHH.js";const F={class:"d-flex align-center justify-space-between mb-2"},L={class:"font-weight-medium"},U={class:"text-caption text-medium-emphasis",style:{"max-inline-size":"40ch",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Y={class:"text-right"},P={key:0},Q={colspan:"5",class:"text-center text-medium-emphasis py-6"},G={class:"text-sm text-medium-emphasis"},ue=I({__name:"index",setup(H){const{withAbort:V}=A(),p=d(!1),m=d(null),i=d(""),f=d([]),u=d({current_page:1,last_page:1,per_page:20,total:0}),_=async(r=1)=>{p.value=!0,i.value="";try{const t=await V(a=>b("/announcements",{query:{page:r},signal:a}));f.value=t.data,u.value=t.meta}catch(t){if(x(t))return;i.value=w(t,"Duyurular alinamadi.")}finally{p.value=!1}},T=async r=>{m.value=r,i.value="";try{await V(t=>b(`/announcements/${r}`,{method:"DELETE",signal:t})),await _(u.value.current_page)}catch(t){if(x(t))return;i.value=w(t,"Duyuru silinemedi.")}finally{m.value=null}};return M(()=>_(1)),(r,t)=>(c(),C(B,null,{default:l(()=>[n(y,{cols:"12"},{default:l(()=>[e("div",F,[t[1]||(t[1]=e("div",null,[e("h4",{class:"text-h4 mb-1"}," Duyurular "),e("p",{class:"text-medium-emphasis mb-0"}," Site duyurularini yonetin ")],-1)),n(h,{color:"primary","prepend-icon":"ri-add-line",to:"/announcements/create"},{default:l(()=>[...t[0]||(t[0]=[g(" Yeni Duyuru ",-1)])]),_:1})])]),_:1}),s(i)?(c(),C(y,{key:0,cols:"12"},{default:l(()=>[n(E,{type:"error",variant:"tonal"},{default:l(()=>[g(o(s(i)),1)]),_:1})]),_:1})):D("",!0),n(y,{cols:"12"},{default:l(()=>[n(z,{loading:s(p)},{default:l(()=>[n(N,{density:"comfortable"},{default:l(()=>[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",null,"Baslik"),e("th",null,"Olusturan"),e("th",null,"Tarih"),e("th",null,"Durum"),e("th",{class:"text-right"}," Islemler ")])],-1)),e("tbody",null,[(c(!0),v(O,null,S(s(f),a=>(c(),v("tr",{key:a.id},[e("td",null,[e("div",L,o(a.title),1),e("div",U,o(a.content),1)]),e("td",null,o(a.created_by?.name??"-"),1),e("td",null,o(s($)(a.created_at)),1),e("td",null,[n(R,{size:"small",color:a.is_published?"success":"secondary",variant:"tonal"},{default:l(()=>[g(o(a.is_published?"Yayinda":"Taslak"),1)]),_:2},1032,["color"])]),e("td",Y,[n(h,{icon:"",size:"small",variant:"text",to:`/announcements/${a.id}`},{default:l(()=>[n(k,{icon:"ri-edit-line"})]),_:1},8,["to"]),n(h,{icon:"",size:"small",variant:"text",color:"error",loading:s(m)===a.id,disabled:s(m)===a.id,onClick:J=>T(a.id)},{default:l(()=>[n(k,{icon:"ri-delete-bin-line"})]),_:1},8,["loading","disabled","onClick"])])]))),128)),s(f).length===0?(c(),v("tr",P,[e("td",Q,o(r.$t("common.noRecords")),1)])):D("",!0)])]),_:1}),n(j,{class:"d-flex justify-space-between align-center flex-wrap gap-3"},{default:l(()=>[e("span",G,o(r.$t("common.totalRecords",{count:s(u).total})),1),n(q,{"model-value":s(u).current_page,length:s(u).last_page,"total-visible":7,"onUpdate:modelValue":_},null,8,["model-value","length"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}))}});export{ue as default};
